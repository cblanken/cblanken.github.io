<!DOCTYPE html>
<html lang="en">



    


<head>
    
    
    
    
    

    <title>cblanken.dev</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">
    <meta name="robots" content="noodp"/>

    <link rel="stylesheet" href="https://www.cblanken.dev/style.css?h=3182f546a1b9a6e33d32">
    <link rel="stylesheet" href="https://www.cblanken.dev/color/orange-auto.css?h=e80c890ed79117afae1d">

    <meta name="description" content="Learn Linux with OverTheWire Bandit.">

    <meta property="og:description" content="Learn Linux with OverTheWire Bandit.">
    <meta property="og:title" content="cblanken.dev">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.cblanken.dev/articles/overthewirebandit/">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="Learn Linux with OverTheWire Bandit.">
    <meta name="twitter:title" content="cblanken.dev">
    <meta property="twitter:domain" content="www.cblanken.dev">
    <meta property="twitter:url" content="https://www.cblanken.dev/articles/overthewirebandit/">

        <!-- Umami Analytics -->
        <script defer src="https://cloud.umami.is/script.js" data-website-id="e421f4ef-172d-42f3-bc26-4bcedb0359b0"></script>
    
        <link rel="shortcut icon" type="image/svg" href="/favicon.svg">
    
    </head>

<body>
<div class="container">
    
    <header class="header">
        <div class="header__inner">
            <div class="header__logo">
                    
                <a href="https://www.cblanken.dev" style="text-decoration: none;">
                    <div class="logo">
                      
                            cblanken.dev
                        
                    </div>
                </a>
            </div>
            <div id="change-lang" class="logo">
                <select>
                    <button>
                            <svg fill="currentColor" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800px" height="800px" viewBox="796 796 200 200" enable-background="new 796 796 200 200" xml:space="preserve"> <g> <path d="M973.166,818.5H818.833c-12.591,0-22.833,10.243-22.833,22.833v109.333c0,12.59,10.243,22.833,22.833,22.833h154.333 c12.59,0,22.834-10.243,22.834-22.833V841.333C996,828.743,985.756,818.5,973.166,818.5z M896,961.5h-77.167 c-5.973,0-10.833-4.859-10.833-10.833V841.333c0-5.974,4.86-10.833,10.833-10.833H896V961.5z M978.58,872.129 c-0.547,9.145-5.668,27.261-20.869,39.845c4.615,1.022,9.629,1.573,14.92,1.573v12c-10.551,0-20.238-1.919-28.469-5.325 c-7.689,3.301-16.969,5.325-28.125,5.325v-12c5.132,0,9.924-0.501,14.366-1.498c-8.412-7.016-13.382-16.311-13.382-26.78h11.999 c0,8.857,5.66,16.517,14.884,21.623c4.641-2.66,8.702-6.112,12.164-10.351c5.628-6.886,8.502-14.521,9.754-20.042h-49.785v-12 h22.297v-11.986h12V864.5h21.055c1.986,0,3.902,0.831,5.258,2.28C977.986,868.199,978.697,870.155,978.58,872.129z"/> <g> <g> <path d="M839.035,914.262l-4.45,11.258h-15.971l26.355-61.09h15.971l25.746,61.09h-16.583l-4.363-11.258H839.035z M852.475,879.876l-8.902,22.604h17.629L852.475,879.876z"/> </g> </g> </g> </svg>
                    </button>
                    
                     
                        
                            
                        
                        <option value="">EN</option>
                     
                        
                            
                        
                        <option value="de">DE</option>
                    
                    <script>
                        let a;
                        document.querySelector("#change-lang").addEventListener("change", e => {
                            window.location = `/${e.target.value}`;
                        });
                    </script>
                </select>
            </div>
        </div>

        
        
    
    
        
            
                
                    
                        
                    
                

                

                
            
                
                    
                        
                    
                

                

                
                    
                
            
                
                    
                        
                    
                

                

                
            
                
                    
                        
                    
                

                

                
            
                
                    
                        
                    
                

                

                
            
                
                    
                        
                    
                

                

                
            
                
                    
                        
                    
                

                

                
            
                

                

                
            

            

            
    
        
        <nav class="menu">
            <ul class="menu__inner">
            
                <li >
                    
                        
                            
                        

                        
                            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;about">About</a>
                        
                    
                </li>
            
                <li  class="active" >
                    
                        
                            
                        

                        
                            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles">Articles</a>
                        
                    
                </li>
            
                <li >
                    
                        
                            
                        

                        
                            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;journal">Journal</a>
                        
                    
                </li>
            
                <li >
                    
                        
                            
                        

                        
                            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;projects">Projects</a>
                        
                    
                </li>
            
                <li >
                    
                        
                            
                        

                        
                            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;archive">Archive</a>
                        
                    
                </li>
            
                <li >
                    
                        
                            
                        

                        
                            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;tags">Tags</a>
                        
                    
                </li>
            
                <li >
                    
                        
                            
                        

                        
                            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;feeds">RSS</a>
                        
                    
                </li>
            
                <li >
                    
                        
                            <a class="external-link" href="https://github.com/cblanken" target="_blank" rel="noopener noreferrer">GitHub</a>
                        
                    
                </li>
            
            </ul>
        </nav>
    

    

        

    </header>
    

     

<div class="post">
  
  <div class="toc-container">
    <div class="toc">
      <div class="toc-header">Table of Contents</div>
      <div class="toc-title">
        <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#title">OverTheWire - Bandit</a>
      </div>
      <div class="toc-items-container">
        <ol class="toc-items">
          
          <li class="toc-item">
            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#introduction">Introduction</a>
            <ol>
              
            </ol>
          </li>
          
          <li class="toc-item">
            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#logging-in">Logging in</a>
            <ol>
              
            </ol>
          </li>
          
          <li class="toc-item">
            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#walkthrough">Walkthrough</a>
            <ol>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-0">Level 0</a>
                <ol>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#useful-commands-1">Useful commands 1</a>
                  </li>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-1">Level 1</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-2">Level 2</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-3">Level 3</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-4">Level 4</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-5">Level 5</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-6">Level 6</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-7">Level 7</a>
                <ol>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#useful-commands-2">Useful commands 2</a>
                  </li>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#regex">Regex</a>
                  </li>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-8">Level 8</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-9">Level 9</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-10">Level 10</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-11">Level 11</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-12">Level 12</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-13">Level 13</a>
                <ol>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#useful-commands-3">Useful commands 3</a>
                  </li>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-14">Level 14</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-15">Level 15</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-16">Level 16</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-17">Level 17</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-18">Level 18</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-19">Level 19</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-20">Level 20</a>
                <ol>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#useful-commands-4">Useful commands 4</a>
                  </li>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#job-control">Job control</a>
                  </li>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#terminal-multiplexing">Terminal multiplexing</a>
                  </li>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#solution">Solution</a>
                  </li>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-21">Level 21</a>
                <ol>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#cron">Cron</a>
                  </li>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#solution-1">Solution</a>
                  </li>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-22">Level 22</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-23">Level 23</a>
                <ol>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#shell-scripting">Shell scripting</a>
                  </li>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#solution-2">Solution</a>
                  </li>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-24">Level 24</a>
                <ol>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#generating-pins">Generating PINs</a>
                  </li>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-25">Level 25</a>
                <ol>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#pagers">Pagers</a>
                  </li>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#solution-3">Solution</a>
                  </li>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#vi-and-vim">Vi and Vim</a>
                  </li>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-26">Level 26</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-27">Level 27</a>
                <ol>
                  
                  <li class="toc-item">
                    <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#git">Git</a>
                  </li>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-28">Level 28</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-29">Level 29</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-30">Level 30</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-31">Level 31</a>
                <ol>
                  
                </ol>
              </li>
              
              <li class="toc-item">
                <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#level-32">Level 32</a>
                <ol>
                  
                </ol>
              </li>
              
            </ol>
          </li>
          
          <li class="toc-item">
            <a href="https:&#x2F;&#x2F;www.cblanken.dev&#x2F;articles&#x2F;overthewirebandit&#x2F;#the-end">The End</a>
            <ol>
              
            </ol>
          </li>
          
        </ol>
      </div>
    </div>
  </div>
   
<h1 id="title" class="post-title">
  <a href="https://www.cblanken.dev/articles/overthewirebandit/">OverTheWire - Bandit</a>
</h1>
 
<div class="post-meta-inline">
  <div>
    <div class="post-sub-title">Published</div>
    <div>
<span class="post-date"> Oct 20, 2024 </span>
</div>
  </div>
  
  <div>
    <div class="post-sub-title">Last edited</div>
    <div>Jun 17, 2025</div>
  </div>
  

  <div>
    <div class="post-sub-title">Reading time</div>
    
    <div>66 minutes</div>
    
  </div>
</div>


<div>
<div class="post-tags">
  <a
    class="post-tag"
    href="https://www.cblanken.dev/tags/git/"
    >#Git</a
  >
  
  <a
    class="post-tag"
    href="https://www.cblanken.dev/tags/linux/"
    >#Linux</a
  >
  
  <a
    class="post-tag"
    href="https://www.cblanken.dev/tags/overthewire/"
    >#OverTheWire</a
  >
  
  <a
    class="post-tag"
    href="https://www.cblanken.dev/tags/vim/"
    >#Vim</a
  >
  
  <a
    class="post-tag"
    href="https://www.cblanken.dev/tags/cron/"
    >#cron</a
  >
  
  <a
    class="post-tag"
    href="https://www.cblanken.dev/tags/ctf/"
    >#ctf</a
  >
  
  <a
    class="post-tag"
    href="https://www.cblanken.dev/tags/infosec/"
    >#infosec</a
  >
  
  <a
    class="post-tag"
    href="https://www.cblanken.dev/tags/tmux/"
    >#tmux</a
  >
  
  <a
    class="post-tag"
    href="https://www.cblanken.dev/tags/wargame/"
    >#wargame</a
  >
  </div>
</div>
 <div class="post-content"><h2 id="introduction"><a class="zola-anchor" href="#introduction" aria-label="Anchor link for: introduction">Introduction</a></h2>
<p><a href="https://overthewire.org/wargames/bandit/">Bandit</a> is just one of several <a href="https://en.wikipedia.org/wiki/Wargame_(hacking)">wargames</a> available at <a href="https://overthewire.org/">overthewire.org</a>. It's aimed at beginners to Linux and CTFs and provides an excellent introduction to the basics of the Linux command line.</p>
<p>In this walkthrough I'm going to show the process for solving each challenge while also providing some insight into what each challenge is trying to teach and why it's useful, so keep an eye out for callouts like those below.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout note">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#info"></use></svg>
    <div>Note</div>
  </div>
  <div class="callout-text">
    <p>Access to each Bandit level is made over SSH. The username will correspond to the index of the level starting at 0. Always make sure you're logging into the correct Bandit level!</p>

  </div>
</div>


<style>
</style>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout warning">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#warn"></use></svg>
    <div>Warning</div>
  </div>
  <div class="callout-text">
    <p>If you're looking for the solution of a particular level, you are highly encouraged to attempt it on your own before following this walkthrough. You will learn some useful things regardless, but attempting it on your own first will help the knowledge stick better. I promise.</p>

  </div>
</div>


<style>
</style>
<p>I have a few recommendations before getting started. Most of the OverTheWire Bandit levels provide links to potentially useful manual pages. Unfortunately the <code>man</code> pages can be somewhat cryptic, especially for beginners. For that reason I recommend the following steps to try to get unstuck when slogging through the <code>man</code> pages for any particular command.</p>
<ol>
<li>Search for examples. Many <code>man</code> pages contain examples of their usage. These may be marked by all-caps <code>EXAMPLES</code> in some cases, but sometimes not.</li>
<li>If skimming through the man pages doesn't surface any apparent examples, then you may want to refer to <a href="https://cheat.sh">cheat.sh</a>. Cheat.sh is a database of usage examples for thousands of command line programs. It can be searched from the main page or by simply adding a <code>/</code> followed by the command. For example <a href="https://cheat.sh/ssh">https://cheat.sh/ssh</a> will return examples of <code>ssh</code> usage. This one can be helpful when trying to understand how a command is commonly used and which command flags are most useful.</li>
<li>If you're struggling to understand some of the examples then paste them into <a href="https://explainshell.com">https://explainshell.com</a>. Explainshell provides a more readable breakdown of each command line flag and argument. This tool can save you a lot of time flipping back and forth through the <code>man</code> pages.</li>
</ol>
<p>Please also note that for any terminal output, the command prompt will be truncated to a single <code>$</code> for brevity. Just remember that you'll need to be logged in to the appropriate level before executing any of the commands.</p>
<p>For example:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat hello.txt
</span><span>Hello there!
</span></code></pre>
<h2 id="logging-in"><a class="zola-anchor" href="#logging-in" aria-label="Anchor link for: logging-in">Logging in</a></h2>
<blockquote>
<p>The goal of this level is for you to log into the game using SSH. The host to which you need to connect is bandit.labs.overthewire.org, on port 2220. The username is bandit0 and the password is bandit0. Once logged in, go to the Level 1 page to find out how to beat Level 1.</p>
</blockquote>
<p><a href="https://overthewire.org/wargames/bandit/bandit0.html">Bandit 0</a> provides an introduction to SSH and provides a couple useful links for further research.</p>
<ul>
<li><a href="https://manpages.ubuntu.com/manpages/noble/man1/ssh.1.html">ssh manual</a></li>
<li><a href="https://en.wikipedia.org/wiki/Secure_Shell">SSH - Wikipedia</a></li>
</ul>
<p>Firstly, let's discuss what SSH is and how it's used day-to-day. SSH is a networking protocol that allows secure communication between networked computer systems. This is distinct from the <code>ssh</code> command line program linked above. The program implements the protocol and allows regular users to utilize the SSH protocol for secure communication. The security of SSH is based on <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public-key cryptography</a> which you're welcome to read more about, but many of the details are out of scope for this walkthrough.</p>
<p>The most important thing you need to know about SSH is that it can be used to login to a computer system with a <code>username</code> and <code>password</code> just as if you were physically present. Except in this case it's another system accessible over the network. This is how it will be used over the course of the Bandit wargame as well as some of the other wargames by OverTheWire.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout note">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#info"></use></svg>
    <div>Note</div>
  </div>
  <div class="callout-text">
    <p>It's worth mentioning that SSH is usually (and preferably) used with an SSH key. More specifically a key-pair. A public key and a private key which are both needed to take advantage of the aforementioned public-key cryptography. I won't go into detail here, but don't worry there are a couple later levels that do utilize SSH keys, so I'll discuss them in more detail when we reach them.</p>

  </div>
</div>


<style>
</style>
<p>The prompt tells us that both the <code>username</code> and <code>password</code> are <code>bandit0</code>.</p>
<p>Just as important though, is the network location we've been provided, <code>bandit.labs.overthewire.org</code>, which we'll use to connect to level 0. Actually, <code>bandit.labs.overthewire.org</code> is what's known as a <a href="https://en.wikipedia.org/wiki/Hostname">hostname</a> or <a href="https://en.wikipedia.org/wiki/Domain_name">domain name</a>. More specifically, it's a <a href="https://en.wikipedia.org/wiki/Fully_qualified_domain_name">fully qualified domain name (FQDN)</a>. You can recognize an FQDN because it will include a <a href="https://en.wikipedia.org/wiki/Top-level_domain">top-level domain (TLD)</a> such as <code>.com</code>, <code>.net</code>, or <code>.org</code>. This naming system for computers is called the <a href="https://en.wikipedia.org/wiki/Domain_Name_System">Domain Name System (DNS)</a>. Luckily we don't need to dig into the details here. Just know that one of these FQDNs will resolve to an <a href="https://en.wikipedia.org/wiki/IP_address">IP address</a> which can (usually) be used to uniquely identify a computer system on the internet.</p>
<p>This unique name will tell the <code>ssh</code> program what system to connect to. The <code>ssh</code> program expects the user credentials and hostname in the following format <code>ssh://[user@]hostname[:port]</code>. This is explained in the first couple paragraphs of the <a href="https://www.man7.org/linux/man-pages/man1/ssh.1.html">ssh man page</a>.</p>
<blockquote>
<p>ssh connects and logs into the specified destination, which may be specified as either <code>[user@]hostname</code> or a URI of the form <code>ssh://[user@]hostname[:port]</code>.</p>
</blockquote>
<p>The elements wrapped in brackets <code>[</code> and <code>]</code> are actually optional. Linux <code>man</code> pages will commonly express the available flags and arguments for a command in this way.</p>
<p>With that knowledge we can now connect to the first level with this command.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">ssh</span><span> ssh://bandit0@bandit.labs.overthewire.org:2220
</span></code></pre>
<p>You should be greeted by a banner for the Bandit wargame and a prompt requesting entry of the <code>bandit0</code> password. Enter <code>bandit0</code> and you're ready to get started.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout note">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#info"></use></svg>
    <div>Note</div>
  </div>
  <div class="callout-text">
    <p>It isn't necessary to solve any of the Bandit levels, but I highly recommend researching DNS. It's intrinsic to how the internet operates and you'll likely encounter it again and again if you pursue any area of IT, software, or cybersecurity.</p>
<p>Resources:</p>
<ul>
<li><a href="https://www.freecodecamp.org/news/what-is-dns-for-beginners/">What is DNS?</a>: an excellent intro to the basics of DNS by freeCodeCamp</li>
<li><a href="https://implement-dns.wizardzines.com">Implement DNS in a weekend</a>: if you have some programming experience, I highly recommend following this walkthrough by Julia Evans</li>
</ul>

  </div>
</div>


<style>
</style>
<h2 id="walkthrough"><a class="zola-anchor" href="#walkthrough" aria-label="Anchor link for: walkthrough">Walkthrough</a></h2>
<h3 id="level-0"><a class="zola-anchor" href="#level-0" aria-label="Anchor link for: level-0">Level 0</a></h3>
<p>Now that we're logged in, it's time to solve the first level.</p>
<blockquote>
<p>The password for the next level is stored in a file called readme located in the home directory. Use this password to login to <code>bandit1</code> using SSH. Whenever you find a password for a level, use SSH (on port 2220) to log into that level and continue the game.</p>
</blockquote>
<h4 id="useful-commands-1"><a class="zola-anchor" href="#useful-commands-1" aria-label="Anchor link for: useful-commands-1">Useful commands 1</a></h4>
<p>The prompt also provides links to the man pages for several commands.</p>
<p>With perhaps the exception of <code>du</code>. Each of these commands is fundamental for any Linux user who wants to effectively use the command line.</p>
<table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/ls.1.html">ls</a></td><td>list the files in a directory</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/cd.1posix.html">cd</a></td><td>change your current directory</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/cat.1.html">cat</a></td><td>display the contents of a file</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/file.1.html">file</a></td><td>display information about the content of a file</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/du.1.html">du</a></td><td>display the disk space used by files</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/find.1.html">find</a></td><td>search the file system for files with various parameters such as filename, file type, file size, etc.</td></tr>
</tbody></table>
<p>You are <em>highly</em> encouraged to review each of the commands. At the very least check out the <code>cheat.sh</code> page for each. Regardless these are all pretty common, so you'll get plenty of experience with these commands in later levels.</p>
<p>For now, it should be apparent that one of the above commands should serve to show us the contents of the <code>readme</code> file mentioned in the prompt. The humble <code>cat</code> command.</p>
<p>It takes a filename as a parameter. So providing it with the filename <code>readme</code> should print it's contents.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat readme
</span><span>Congratulations on your first steps into the bandit game!!
</span><span>Please make sure you have read the rules at https://overthewire.org/rules/
</span><span>If you are following a course, workshop, walkthrough or other educational activity,
</span><span>please inform the instructor about the rules as well and encourage them to
</span><span>contribute to the OverTheWire community so we can keep these games free!
</span><span>
</span><span>The password you are looking for is: [REDACTED PASSWORD]
</span></code></pre>
<p>I won't be providing any of the passwords throughout this walkthrough per the OverTheWire <a href="https://overthewire.org/rules/">rules</a>. So get out your notepad and copy those passwords. You'll need them to return to the last level you've completed without completing each level again. Once you've done that, you're ready to continue to Level 1.</p>
<h3 id="level-1"><a class="zola-anchor" href="#level-1" aria-label="Anchor link for: level-1">Level 1</a></h3>
<blockquote>
<p>The password for the next level is stored in a file called <code>-</code> located in the home directory</p>
</blockquote>
<p>The prompt also provides links to the man pages for the same commands as level 0.</p>
<p>Naturally, you might think to try the <code>cat</code> command again. Afterall, we're told the password in in the file called <code>-</code>. Let's try it and see what happens.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat -
</span><span>█
</span></code></pre>
<p>Strange, you're left with a blank line on the terminal now. And, if you type some text and press the <code>Enter</code> key, the text is repeated back to the terminal like so.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat -
</span><span>hello there
</span><mark style="background-color:#65737e30;"><span>hello there
</span></mark></code></pre>
<p>The reason for this will become clear if you read the description from the <code>cat</code> man page.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>NAME
</span><span>   cat - concatenate files and print on the standard output
</span><span>
</span><span>SYNOPSIS
</span><span>   cat [OPTION]... [FILE]...
</span><span>
</span><mark style="background-color:#65737e30;"><span>DESCRIPTION
</span></mark><mark style="background-color:#65737e30;"><span>   Concatenate FILE(s) to standard output.
</span></mark><mark style="background-color:#65737e30;"><span>   With no FILE, or when FILE is -, read standard input.
</span></mark></code></pre>
<p>So, according to the description, the parameter <code>-</code>, makes <code>cat</code> read from standard input. You may have guessed this already, but standard input or STDIN is usually what's entered by the user in the terminal; however, STDIN doesn't explicitly refer to input from a user. Rather, it refers to a <em>stream</em> of data that is being sent to a program, so it may also refer to files or even the output of other programs that is being passed to other programs.</p>
<p>You'll most likely hear of this concept of input and output referred to as STDIO or standard input and output. If you'd like to read more, there is an <a href="https://www.freecodecamp.org/news/introduction-to-linux/#heading-standard-file-streams">excellent article by freeCodeCamp</a> explaining more about it and many other useful concepts.</p>
<p>There will be opportunities to demonstrate STDIO and IO redirection later, but for this level, all you need to recognize is that <code>-</code> is a special character that tells cat to read input from STDIN instead of a file as we saw before. So to properly refer to the <code>-</code> file, it must be referenced by some other means than the simple filename. There are several ways to accomplish that.</p>
<ol>
<li>
<p>Use <code>./&lt;filename&gt;</code> where <code>&lt;filename&gt;</code> would be <code>-</code> for this example. The <code>.</code> is a special character that is interpreted as the current directory. This is usually implied when we just enter a file by it's name. However, stating it explicitly allows us to circumvent the special case of using <code>-</code> as an argument to <code>cat</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat ./-
</span><span>[REDACTED PASSWORD]
</span></code></pre>
</li>
<li>
<p>Use the full path. On Linux and other Unix-based systems the <a href="https://en.wikipedia.org/wiki/Root_directory">root of the file system</a> can be specified with a <code>/</code>. To use this method though we'll need to know the full path of the <code>-</code> file. To get that we can use the <code>pwd</code> command, which is short for "print working directory".</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ pwd
</span><span>/home/bandit1
</span></code></pre>
<p>To complete the full path for <code>-</code> we just need to append <code>/&lt;filename&gt;</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat /home/bandit1/-
</span><span>[REDACTED PASSWORD]
</span></code></pre>
</li>
<li>
<p>We can also use what is called a glob (<code>*</code>). The glob can be used to execute commands over multiple files at once. For example using the following command will print all files in the current working directory.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat ./*
</span><span>[REDACTED PASSWORD]
</span></code></pre>
<p>In this example the only file in our current directory is the password file <code>-</code>. But just like the other examples it circumvents the special <code>-</code> argument to <code>cat</code>.</p>
<p>The glob is actually a part of a larger set of <a href="https://www.gnu.org/software/bash/manual/bash.html#Filename-Expansion">filename expansion</a> features available in Bash. They're quite useful and we may see more of them in future levels.</p>
</li>
</ol>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout tip">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#tip"></use></svg>
    <div>Tip</div>
  </div>
  <div class="callout-text">
    <p>The main takeway from this level is that there are special characters that may change how commands are interpreted on the command line. Some of them will be built-in to whatever shell you're using, but some may just be conventions like the <code>-</code> character for STDIN and won't apply to every program. Here is a breakdown of the special characters used in the Bash shell that you might want to watch out for. <a href="https://mywiki.wooledge.org/BashGuide/SpecialCharacters">https://mywiki.wooledge.org/BashGuide/SpecialCharacters</a></p>

  </div>
</div>


<style>
</style>
<h3 id="level-2"><a class="zola-anchor" href="#level-2" aria-label="Anchor link for: level-2">Level 2</a></h3>
<blockquote>
<p>The password for the next level is stored in a file called <code>spaces in this filename</code> located in the <code>home</code> directory</p>
</blockquote>
<p>This level is similar to Level 1, except that the file is not a special character. Instead it contains special characters, the space █. The space character is essential for the shell to interpret the input text.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat spaces in this filename
</span><span>cat: spaces: No such file or directory
</span><span>cat: in: No such file or directory
</span><span>cat: this: No such file or directory
</span><span>cat: filename: No such file or directory
</span></code></pre>
<p>As you can see from above, entering the name as it's written will cause the <code>cat</code> command to interpret each word in the file as a separate filename.</p>
<p>Just as before, there are a few ways to get around this.</p>
<ol>
<li>
<p>Escape the space characters. In Bash, the backslash <code>\</code> is used as an <a href="https://www.gnu.org/software/bash/manual/bash.html#Escape-Character">escape character</a>. When the <code>\</code> is used, the following character is interpreted literally. This allows the space characters of the filename to be "escaped".</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat spaces\ in\ this\ filename
</span><span>[REDACTED PASSWORD]
</span></code></pre>
</li>
<li>
<p>Instead of escaping the spaces individually, the filename can also be surrounded by <a href="https://www.gnu.org/software/bash/manual/bash.html#Single-Quotes">single quotes</a>. Every character between two single quotes is interpreted literally.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat &#39;spaces in this filename&#39;
</span><span>[REDACTED PASSWORD]
</span></code></pre>
</li>
<li>
<p>Similarly, <a href="https://www.gnu.org/software/bash/manual/bash.html#Double-Quotes">double quotes</a> can also be used to interpret the surrounded characters literally. However, there are some exceptions, and double quotes allow some special characters to be interpreted. But the space character is not one those, so it is functionally the same as the above example in this case.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat &quot;spaces in this filename&quot;
</span><span>[REDACTED PASSWORD]
</span></code></pre>
</li>
</ol>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout tip">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#tip"></use></svg>
    <div>Tip</div>
  </div>
  <div class="callout-text">
    <p>Recognize that it's sometimes necessary to escape characters within filenames and other arguments.</p>
<p>Most Linux users will avoid naming files with any special characters, but sometimes you'll still run into them. This is especially true with files created on Windows where spaces inside file and directory names are much more common.</p>

  </div>
</div>


<style>
</style>
<h3 id="level-3"><a class="zola-anchor" href="#level-3" aria-label="Anchor link for: level-3">Level 3</a></h3>
<blockquote>
<p>The password for the next level is stored in a hidden file in the <code>inhere</code> directory.</p>
</blockquote>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ls ./inhere
</span></code></pre>
<p>According to the <code>ls</code> command, there don't appear to be any files in the <code>inhere</code> directory. That's because <code>ls</code> doesn't display hidden files by default.</p>
<p>To show hidden files with <code>ls</code>, it's necessary to use the <code>--all</code> or <code>-a</code> flag.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ls -a ./inhere
</span><span>.  ..  ...Hiding-From-You
</span></code></pre>
<p>With the <code>--all</code> flag enabled, <code>ls</code> now shows all the files in the <code>inhere</code> directory. Including the hidden files. In Linux and other Unix-based systems, a leading dot <code>.</code> in a filename is used to indicate a hidden file. As such, you may here them referred to as dotfiles.</p>
<p>Now that we know the name of the hidden file, <code>cat</code> can be used to print the contents just as we've seen before.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat inhere/...Hiding-From-You
</span><span>[REDACTED PASSWORD]
</span></code></pre>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout note">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#info"></use></svg>
    <div>Note</div>
  </div>
  <div class="callout-text">
    <p>The term "dotfile" is also frequently used to refer to a user's personal configuration files. This is because many configuration files follow the leading dot <code>.</code> convention, so they don't clutter up directory listings.</p>

  </div>
</div>


<style>
</style>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout tip">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#tip"></use></svg>
    <div>Tip</div>
  </div>
  <div class="callout-text">
    <p>Some systems will have aliases for the <code>ls</code> command as well, with various flags enabled. Here a few common ones.</p>
<ul>
<li><code>ll</code> for <code>ls -AlhF</code> to list all files in a human-readable, long format</li>
<li><code>la</code> for <code>ls -A</code> to list all files excluding <code>.</code> and <code>..</code></li>
<li><code>l</code> for <code>ls -CF</code> to list files in a column format</li>
<li><code>lsd</code> for <code>ls --group-directories-first</code></li>
</ul>
<p>See <a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-useful-bash-aliases-and-functions">this DigitalOcean article</a> to learn more about common aliases and how to configure your own.</p>

  </div>
</div>


<style>
</style>
<h3 id="level-4"><a class="zola-anchor" href="#level-4" aria-label="Anchor link for: level-4">Level 4</a></h3>
<blockquote>
<p>The password for the next level is stored in the only human-readable file in the <code>inhere</code> directory. Tip: if your terminal is messed up, try the <code>reset</code> command.</p>
</blockquote>
<p>If you haven't done so already, now would be a good time to read through the manual for each of the commands that were already mentioned in <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-0">Level 0</a>.</p>
<p>If you've read through the description for each, you should have a pretty good idea of which command you'll need to solve this one.</p>
<p>This level is asking us to identify which files in <code>inhere</code> are human readable. The <code>file</code> command can get the information we need.</p>
<p>From the <code>file</code> manual page we know that we can expect a response of <code>text</code> for any files that only contain typical <a href="https://en.wikipedia.org/wiki/ASCII#Character_set">ASCII characters</a>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>The  type  printed  will  usually  contain one of the words `text` (the file
</span><span>contains only printing characters and a few common control characters and is
</span><span>probably safe to read on an ASCII terminal), `executable` (the file contains
</span><span>the result of compiling a program  in  a form  understandable to some UNIX
</span><span>kernel or another), or `data` meaning anything else (data is usually “binary”
</span><span>or non-printable).
</span></code></pre>
<p>One option is to execute <code>file</code> on each file in <code>inhere</code> one-by-one like so.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ file inhere/-file00
</span><span>inhere/-file00: data
</span></code></pre>
<p>A better way is to use the glob <code>*</code> that we've seen previously. This allows us to run the file command on all the files at once.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ file ./inhere/*
</span><span>./inhere/-file00: data
</span><span>./inhere/-file01: data
</span><span>./inhere/-file02: data
</span><span>./inhere/-file03: data
</span><span>./inhere/-file04: data
</span><span>./inhere/-file05: data
</span><span>./inhere/-file06: data
</span><mark style="background-color:#65737e30;"><span>./inhere/-file07: ASCII text
</span></mark><span>./inhere/-file08: data
</span><span>./inhere/-file09: data
</span></code></pre>
<p>From here it's obvious that we want the file with the text data at <code>./inhere/-file07</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat ./inhere/-file07
</span><span>[REDACTED PASSWORD]
</span></code></pre>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout tip">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#tip"></use></svg>
    <div>Tip</div>
  </div>
  <div class="callout-text">
    <p>Always keep an eye out for opportunities to use globbing. Especially if you're running commands over a bunch of files.</p>

  </div>
</div>


<style>
</style>
<h3 id="level-5"><a class="zola-anchor" href="#level-5" aria-label="Anchor link for: level-5">Level 5</a></h3>
<blockquote>
<p>The password for the next level is stored in a file somewhere under the <code>inhere</code> directory and has all of the following properties:</p>
<ul>
<li>human-readable</li>
<li>1033 bytes in size</li>
<li>not executable</li>
</ul>
</blockquote>
<p>This level requires a precise approach to locate the correct file. While it's technically possible to solve with just the <code>ls</code> and <code>file</code> commands. It would require some tedious manual searching to find the files that match each of the criteria. Luckily the <code>find</code> command is capable of locating files with all the above criteria. You just need to know the right flags.</p>
<p>The <code>find</code> command is essential to efficiently locating files on Linux systems. It has several flags that can be used to refine its search. Most importantly for this level are <code>-readable</code>, <code>-size</code> and <code>-executable</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ find -readable -size 1033c -not -executable
</span><span>./inhere/maybehere07/.file2
</span></code></pre>
<p>Note <code>-size</code> and <code>-not</code> flags. The <code>c</code> suffix for the <code>-size</code> argument is used to indicate a size in bytes. The other available suffixes are all available in the <a href="https://manpages.ubuntu.com/manpages/noble/man1/find.1.html">find man page</a>. Additionally, the <code>-not</code> flag negates the next expression, thus locating any files that aren't executable in this example.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout note">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#info"></use></svg>
    <div>Note</div>
  </div>
  <div class="callout-text">
    <p>In this case the content and size of the file are sufficient to uniquely identify the file and the <code>-not -executable</code> isn't strictly necessary.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ find -readable -size 1033c
</span><span>./inhere/maybehere07/.file2
</span></code></pre>

  </div>
</div>


<style>
</style>
<p>Once again, <code>cat</code> the file to get the password.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat ./inhere/maybehere07/.file2
</span><span>[REDACTED PASSWORD]
</span></code></pre>
<h3 id="level-6"><a class="zola-anchor" href="#level-6" aria-label="Anchor link for: level-6">Level 6</a></h3>
<blockquote>
<p>The password for the next level is stored somewhere on the server and has all of the following properties:</p>
<ul>
<li>owned by user bandit7</li>
<li>owned by group bandit6</li>
<li>33 bytes in size</li>
</ul>
</blockquote>
<p>This level is very similar to <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-5">Level 5</a> with a couple minor differences. First, the file is "stored somewhere on the server" instead of in the <code>inhere</code> directory. That just means we'll need to run the <code>find</code> command from the root of the file system to ensure the file isn't missed. Secondly, the file is specified by two new parameters. The <a href="https://wiki.archlinux.org/title/Users_and_groups">user and group</a> that own the file.</p>
<p>Searching the <code>find</code> manpage you can find the two flags <code>-user</code> and <code>-group</code> to filter for files owned by the <code>bandit7</code> user and the <code>bandit6</code> group as specified by the prompt. The final parameter is for a <code>-size</code> of 33 bytes which we already saw in level 5.</p>
<p>Here's an example of the output from <code>find</code> with all the required arguments.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ find / -user bandit7 -group bandit6 -size 33c
</span><span>find: ‘/drifter/drifter14_src/axTLS’: Permission denied
</span><span>find: ‘/root’: Permission denied
</span><span>find: ‘/snap’: Permission denied
</span><span>find: ‘/tmp’: Permission denied
</span><span>find: ‘/proc/tty/driver’: Permission denied
</span><span>find: ‘/proc/250118/task/250118/fd/6’: No such file or directory
</span><span>find: ‘/proc/250118/task/250118/fdinfo/6’: No such file or directory
</span><span>find: ‘/proc/250118/fd/5’: No such file or directory
</span><span>...
</span><span>[TRUNCATED OUTPUT]
</span></code></pre>
<p>Unfortunately searching with <code>find</code> from <code>/</code> has a side effect. Any files or directories that the current user is not allowed to read will print an error to the terminal. This makes it pretty difficult to parse the output for any resulting files that match our search. To avoid this flood of errors, a common solution is to redirect the standard error stream to <a href="https://www.digitalocean.com/community/tutorials/dev-null-in-linux"><code>/dev/null</code></a> This is actually just a file that discards anything written to it.</p>
<p>To redirect a data stream in Bash we must specify its <a href="https://en.wikipedia.org/wiki/File_descriptor">file descriptor</a>, which is an integer. The file descriptor is followed by a greater than sign <code>&gt;</code> which indacates that the stream should be redirected to a target file. Here is the same command as above with all errors redirect to <code>/dev/null</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ find / -user bandit7 -group bandit6 -size 33c 2&gt;/dev/null
</span><mark style="background-color:#65737e30;"><span>/var/lib/dpkg/info/bandit7.password
</span></mark></code></pre>
<p>As you can see, the output is considerably easier to understand. Read the file at <code>/var/lib/dpkg/info/bandit7.password</code> to get the next password.</p>
<h3 id="level-7"><a class="zola-anchor" href="#level-7" aria-label="Anchor link for: level-7">Level 7</a></h3>
<blockquote>
<p>The password for the next level is stored in the file <code>data.txt</code> next to the word "millionth".</p>
</blockquote>
<h4 id="useful-commands-2"><a class="zola-anchor" href="#useful-commands-2" aria-label="Anchor link for: useful-commands-2">Useful commands 2</a></h4>
<p>This is the first level that OverTheWire introduces some new recommended commands since <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-0">level 0</a>.</p>
<table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/man.1.html">man</a></td><td>access the system reference manuals</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/grep.1.html">grep</a></td><td>print lines that match patterns</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/sort.1.html">sort</a></td><td>sort lines in text files</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/uniq.1.html">uniq</a></td><td>remove duplicate lines from a file</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/strings.1.html">strings</a></td><td>print readable strings from arbitrary files (even binary)</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/base64.1.html">base64</a></td><td>encode data into <a href="https://en.wikipedia.org/wiki/Base64">Base64</a></td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/tr.1.html">tr</a></td><td>translate and replace characters</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/tar.1.html">tar</a></td><td>a utility for archive files</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/gzip.1.html">gzip</a></td><td>a utility for compressing files</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/bzip2.1.html">bzip2</a></td><td>a utility for compressing files</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/xxd.1.html">xxd</a></td><td>a tool for creating a hex dump of a file</td></tr>
</tbody></table>
<p>Once again, I highly recommend at least reading through the introduction for each of these commands and checking out the examples at <a href="https://cheat.sh">cheat.sh</a>.</p>
<p>If you've followed the above advice, there should really only be one contender to solve this level. The <code>grep</code> command.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>NAME
</span><span>   grep - print lines that match patterns
</span><span>
</span><span>SYNOPSIS
</span><span>   grep [OPTION...] PATTERNS [FILE...]
</span><span>   grep [OPTION...] -e PATTERNS ... [FILE...]
</span><span>   grep [OPTION...] -f PATTERN_FILE ... [FILE...]
</span><span>
</span><span>DESCRIPTION
</span><span>   grep  searches for PATTERNS in each FILE. PATTERNS is one or more
</span><span>   patterns separated by newline characters, and grep prints each line that
</span><span>   matches a pattern. Typically PATTERNS should be quoted when grep is used in a
</span><span>   shell command.
</span><span>
</span></code></pre>
<p>According to the syntax description we should be able to search for patterns in a file with the following syntax.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>grep &lt;PATTERN&gt; &lt;FILE&gt;
</span></code></pre>
<p>Swapping in the values mentioned in the prompt will return the line we're looking for.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ grep &quot;millionth&quot; data.txt
</span><mark style="background-color:#65737e30;"><span>millionth       [REDACTED PASSWORD]
</span></mark></code></pre>
<h4 id="regex"><a class="zola-anchor" href="#regex" aria-label="Anchor link for: regex">Regex</a></h4>
<p>Grep and more generally <a href="https://en.wikipedia.org/wiki/Regular_expression">regular expressions</a> (regex) are extremely useful. You'll find many applications have integrated support for text search via regex. In particular text editors, word processors, and programming IDEs.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout tip">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#tip"></use></svg>
    <div>Tip</div>
  </div>
  <div class="callout-text">
    <p>To explore regex more I highly recommend reading through the <a href="https://www.regular-expressions.info/quickstart.html">Regex Quick Start Guide</a> from <a href="https://www.regular-expressions.info">regular-expression.info</a> to get a feel for what's possible with regex and then follow that up with some experimentation on <a href="https://regex101.com">regex101.com</a>. This is a tool that visualizes regex matches. Drop any text you want into it and try out all kinds of search patterns. Try to match words, letters, various combinations of upper and lowercase letters, punctuation, etc. Seeing regex in action and observing precisely what matches with different patterns will give you a much better intuition for what's possible than anything I could write here.</p>
<p>Regex can get very complicated very quickly, so regex101 is also a great tool for debugging your regex. Definitely give it a bookmark, it'll be a life saver. Trust me.</p>

  </div>
</div>


<style>
</style>
<h3 id="level-8"><a class="zola-anchor" href="#level-8" aria-label="Anchor link for: level-8">Level 8</a></h3>
<blockquote>
<p>The password for the next level is stored in the file <code>data.txt</code> and is the only line of text that occurs only once</p>
</blockquote>
<p>This level is the first that seriously benefits from chaining two commands together. In Bash this is done with the pipe <code>|</code> character. The pipe, when placed after a command will pass all of the output (stdout) into the input (stdin) of the command that follows it.</p>
<p>For example, we can combine the <code>ls</code> and <code>grep</code> commands to list only those files that contain "bash" in the name.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ls -a | grep bash
</span><span>.bash_logout
</span><span>.bashrc
</span></code></pre>
<p>Remember that the <code>-a</code> flag is necessary to list hidden or dot files.</p>
<p>Read through the <a href="https://ryanstutorials.net/linuxtutorial/piping.php">Piping and Redirection</a> article provided under the helpful reading material section to learn more about piping.</p>
<p>Reviewing the recommended commands, one should stick out.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>NAME
</span><span>   uniq - report or omit repeated lines
</span><span>
</span><span>SYNOPSIS
</span><span>   uniq [OPTION]... [INPUT [OUTPUT]]
</span><span>
</span><span>DESCRIPTION
</span><span>   Filter adjacent matching lines from INPUT (or standard input), writing
</span><span>to OUTPUT (or standard output).
</span><span>
</span><span>   With no options, matching lines are merged to the first occurrence.
</span></code></pre>
<p>The <code>uniq</code> command is able to filter matching or repeated lines. Since we're looking for a unique line in a file, this will be helpful. However, there is one caveat when using <code>uniq</code> that you must be aware of. The <code>uniq</code> command filters <em>adjacent matching</em> lines. This means that any matching lines that aren't directly adjacent, won't be filtered. So the first step must be to organize the file such that matching lines are adjacent. In other words the file should be sorted. The <code>sort</code> program is designed precisely for this use case.</p>
<p>For example, here's the first 20 lines of <code>data.txt</code> when sorted.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ sort data.txt | head -n20
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span></code></pre>
<p>As mentioned before, the pipe <code>|</code> is useful here to send the output of the <code>sort</code> command to <code>uniq</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ sort data.txt | uniq | head -n20
</span><span>0BKVRLEJQcpNx8wnSPxDLFnFKlQafKK6
</span><span>0eJPctF8gK96ykGBBaKydhJgxSpTlJtz
</span><span>0kJ7XHD4gVtNSZIpqyP1V45sfz9OBLFo
</span><span>0lPOvKhpHZebxji0gdjtGCd5GWiZnNBj
</span><span>0REUhKk0yMqQOwei6NK9ZqIpE5dVlWWM
</span><span>1jfUH1m4XCjr7eWAeleGdaNSxFXRtX0l
</span><span>1VKPEkd0bCtIRwMFVQfY7InulwOFyDsn
</span><span>2u8fvAzvnaFlvQG3iPt4Wc1TFhPcGxhH
</span><span>35l6mr3f6TvlJyDwU6aUgJX07cLhr6t9
</span><span>3FIgajXBiaQAiTMVGo1gxRDSiACNyvvJ
</span><span>3mNA2le0gfURQKNHVIhGkMNLqLwjyyLN
</span><span>4CKMh1JI91bUIZZPXDqGanal4xvAg0JM
</span><span>4P8FsHcdr7d5WKnPtAaXY5SslKICd2gL
</span><span>5EmwMKZHwF6Lwq5jHUaDlfFJBeHbcX0b
</span><span>5hYz0028e1Q2TrtPVz5GZbpMzZNjebhh
</span><span>5I2jWpqjtVp576xXI2TLh1UCyXJtGQ78
</span><span>6Boy6esAjnIxCYn8uI6KZ7VD7zysDM8i
</span><span>7cP8ssLElERHXqOJc9T84bxsmJBjNXk2
</span><span>7qHmEo1FEbzthgyNpKc38YofXjYKZv18
</span><span>8FCtUQlFXsJnNeyiDY5KfE3vRy6sZFEJ
</span></code></pre>
<p>Well that's strange. Why has <code>uniq</code> returned all those lines? If you read the description for <code>uniq</code> carefully, then one line explains this.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>With no options, matching lines are merged to the first occurrence.
</span></code></pre>
<p>So essentially what we have here is a file with each unique line of the file where adjacent duplicates have been compressed into a single line. However, we want to list <em>only</em> the unique lines from the input. For that, the <code>-u</code> flag will meet our needs. The <code>-u</code> flag tells sort to only print <em>unique</em> lines. In other words, only lines without any duplicates in the input.</p>
<p>So finally, we have a solution.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ sort data.txt | uniq -u
</span><span>[REDACTED PASSWORD]
</span></code></pre>
<h3 id="level-9"><a class="zola-anchor" href="#level-9" aria-label="Anchor link for: level-9">Level 9</a></h3>
<blockquote>
<p>The password for the next level is stored in the file <code>data.txt</code> in one of the few human-readable strings, preceded by several ‘=’ characters.</p>
</blockquote>
<p>Once again we're searching a file, so exploring our options with <code>grep</code> may be a good idea.</p>
<p>Trying a basic <code>grep</code> for several <code>=</code> characters doesn't seem to work.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ grep &#39;=== \w*&#39; data.txt
</span><span>grep: data.txt: binary file matches
</span></code></pre>
<p>The <code>\w</code> is a shortcut for any word characters which equivalent to <code>[a-zA-Z0-9_]</code>.</p>
<p>We can see here, that grep found some matches, but <code>data.txt</code> was interpreted as a binary file. We can force grep to process the file as if it were text with the <code>-a</code> flag.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ grep -a &#39;=== \w*&#39; data.txt
</span><span>D]
</span><span>  h#!QJsVzl7POl%Y]Ha^UvToD|@T^N8g}b}?
</span><mark style="background-color:#65737e30;"><span>Q#gm1x}========== theѦ+idW^)F1&gt;)٘SK3PZt&amp;xs肉WB/2ÜB       Ź/Bjɢ&lt;7&lt;u/d|
</span></mark><span>                                                                    -n
</span><span>#iu=
</span><span>    7֣n)Uջش5bBKK}x&gt;}:4Rl_7gHD:274CFy
</span><mark style="background-color:#65737e30;"><span>6!&amp;zB$l_GphqI.02H$Twm⧫o3mt0p~L3JprD========== passwordi L ~ˏ&lt;@Ȅh$%Q5Dk |3
</span></mark><span>~Tf;o9sP#t+Pe΢쵟
</span><span>OqDf.8Czmnf&amp;vl:FXKbM
</span><span>                 CIBi&gt;Y
</span><mark style="background-color:#65737e30;"><span>Еk      $nXT=~}*4a2?TO&quot;&#39;&amp;J~fDV3========== isd5z(#&amp;s!10&amp;poq
</span></mark><span>nR F
</span><span>    z|!(if+A64+&#39;FTb5A}
</span><span>éT:kAU2Qcɐ%#g+;YA_ekrX53|f8+e~&amp;Oiu?VhM}^Qp^G==6!sT:     &quot;uVa-t\fg
</span><mark style="background-color:#65737e30;"><span>]󈍅(.ۍg:7nnp CD`voSQ-&lt;]`@#H UumBiAj堵!O&amp;D9========== [REDACTED PASSWORD]
</span></mark><span>
</span></code></pre>
<p>On the last line of the above output, you'll find the password to the next level.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout tip">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#tip"></use></svg>
    <div>Tip</div>
  </div>
  <div class="callout-text">
    <p>It's possible for <code>grep</code> to output the precise matching text instead of each entire line. The <code>-o</code> flag is needed to do this. It tells grep to only output the matched pattern.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ grep -a -o &#39;=== \w*&#39; data.txt
</span><span>=== the
</span><span>=== passwordi
</span><span>=== is
</span><span>=== [REDACTED PASSWORD]
</span></code></pre>
<p>This gives a much clearer picture of the password without all the surrounding binary data.</p>

  </div>
</div>


<style>
</style>
<h3 id="level-10"><a class="zola-anchor" href="#level-10" aria-label="Anchor link for: level-10">Level 10</a></h3>
<blockquote>
<p>The password for the next level is stored in the file <code>data.txt</code>, which contains <strong>base64</strong> encoded data</p>
</blockquote>
<p>This one is pretty straight forward. The prompt gives it away by mentioning that the data is Base64 encoded.</p>
<p>Check the manual for the <code>base64</code> command and you'll find one of the first flags is <code>-d</code> for <code>--decode</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ base64 -d data.txt
</span><mark style="background-color:#65737e30;"><span>The password is [REDACTED PASSWORD]
</span></mark></code></pre>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout note">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#info"></use></svg>
    <div>Note</div>
  </div>
  <div class="callout-text">
    <p>Be sure you understand what <em>encoding</em> is in this context.</p>
<p><a href="https://en.wikipedia.org/wiki/Base64">Base64</a> is just one scheme of many to convert binary data into printable characters i.e. alphanumeric characters with the addition of the equal sign <code>=</code>. In fact, that equal sign <code>=</code> is used for padding the end of encoded text, so it's often a dead giveaway that some text was Base64 encoded. For example, the word "password" when Base64 encoded is <code>cGFzc3dvcmQ=</code>.</p>
<p>Base64 encoded text is extremely common on the web and you're likely to come across it at some point, so it may behoove you to read up on it. FreeCodeCamp has an <a href="https://www.freecodecamp.org/news/what-is-base64-encoding/">excellent article</a> that gives a good overview of how Base64 works and what it's used for.</p>
<p>You're less likely see other forms of binary to text encoding, but feel free to <a href="https://en.wikipedia.org/wiki/Binary-to-text_encoding">read more</a>.</p>

  </div>
</div>


<style>
</style>
<h3 id="level-11"><a class="zola-anchor" href="#level-11" aria-label="Anchor link for: level-11">Level 11</a></h3>
<blockquote>
<p>The password for the next level is stored in the file data.txt, where all lowercase (a-z) and uppercase (A-Z) letters have been rotated by 13 positions</p>
</blockquote>
<p>This challenge is describing what's commonly known as a shift cipher or <a href="https://en.wikipedia.org/wiki/Caesar_cipher">Caesar cipher</a>. It's not actually used in modern times for any meaningful attempts at securing messages, but it's somewhat popular in CTFs and wargames.</p>
<p>To keep within the spirit of the wargame, let's first go over how you might solve this challenge in the terminal. One of the recommended commands is <code>tr</code> which can "[t]ranslate, squeeze, and/or delete characters" according to the description. Here's a few different ways to go about it.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;"># Rotate the alphabet by 13 letters where both input and output are explicit
</span><span style="color:#bf616a;">cat</span><span> data.txt | </span><span style="color:#bf616a;">tr </span><span>&quot;</span><span style="color:#a3be8c;">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ</span><span>&quot; &quot;</span><span style="color:#a3be8c;">nopqrstuvwxyzabcdefghijklmNOPQRSTUVWXYZABCDEFGHIJKLM</span><span>&quot;
</span><span>
</span><span style="color:#65737e;"># Similar to above except the input is defined by a regular expression
</span><span style="color:#bf616a;">cat</span><span> data.txt | </span><span style="color:#bf616a;">tr </span><span>&quot;</span><span style="color:#a3be8c;">a-zA-Z</span><span>&quot; &quot;</span><span style="color:#a3be8c;">nopqrstuvwxyzabcdefghijklmNOPQRSTUVWXYZABCDEFGHIJKLM</span><span>&quot;
</span><span>
</span><span style="color:#65737e;"># Similar to above except both the input and output are defined by a regular expression
</span><span style="color:#65737e;"># Note: the odd arrangement for the output is the necessary since Regex doesn&#39;t allow
</span><span style="color:#65737e;"># the letter ranges to wrap around
</span><span style="color:#bf616a;">cat</span><span> data.txt | </span><span style="color:#bf616a;">tr </span><span>&quot;</span><span style="color:#a3be8c;">a-zA-Z</span><span>&quot; &quot;</span><span style="color:#a3be8c;">n-za-mN-ZA-M</span><span>&quot;
</span></code></pre>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout tip">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#tip"></use></svg>
    <div>Tip</div>
  </div>
  <div class="callout-text">
    <p>While the <code>tr</code> command is cool and all, there's an even cooler tool you should be using when investigating any challenge related to cryptography. And that's <a href="https://gchq.github.io/CyberChef">CyberChef</a>. CyberChef has a huge number of useful features for transforming data and supports hundreds of data formats and encoding schemes.</p>
<p>Check out the <a href="https://gchq.github.io/CyberChef/#recipe=ROT13(true,true,false,13)">CyberChef ROT13 cipher solver</a>.</p>

  </div>
</div>


<style>
</style>
<h3 id="level-12"><a class="zola-anchor" href="#level-12" aria-label="Anchor link for: level-12">Level 12</a></h3>
<blockquote>
<p>The password for the next level is stored in the file <code>data.txt</code>, which is a hexdump of a file that has been repeatedly compressed. For this level it may be useful to create a directory under <code>/tmp</code> in which you can work. Use <code>mkdir</code> with a hard to guess directory name. Or better, use the command <code>mktemp -d</code>. Then copy the datafile using <code>cp</code>, and rename it using <code>mv</code> (read the manpages!)</p>
</blockquote>
<p>This challenge is quite tedious. As the prompt mentions, it's a good idea to create a temp directory to work with all the files. For example <code>mkdir /tmp/my-super-secret-directory</code> followed by <code>mv ~/data.txt /tmp/my-super-secret-directory</code>. Now we're ready to begin.</p>
<p>The first step is to recognize the format of the <code>data.txt</code>.</p>
<p>Taking a look at the first few lines shows that this file isn't just a text file. It's a hexdump. Read the first few lines with <code>head -n5 data.txt</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>00000000: 1f8b 0808 dfcd eb66 0203 6461 7461 322e  .......f..data2.
</span><span>00000010: 6269 6e00 013e 02c1 fd42 5a68 3931 4159  bin..&gt;...BZh91AY
</span><span>00000020: 2653 59ca 83b2 c100 0017 7fff dff3 f4a7  &amp;SY.............
</span><span>00000030: fc9f fefe f2f3 cffe f5ff ffdd bf7e 5bfe  .............~[.
</span><span>00000040: faff dfbe 97aa 6fff f0de edf7 b001 3b56  ......o.......;V
</span></code></pre>
<p>Don't panic! You don't need to be able to read this stuff right away. Just recognizing it as a hexdump is enough. Fortunately, one of the recommended commands is made specifically to handle hexdumps. The <a href="https://manpages.ubuntu.com/manpages/noble/man1/xxd.1.html">xxd</a> command.</p>
<p>Using <code>xxd</code> with the <code>-r</code> flag can reverse the hexdump into a binary file.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">xxd -r</span><span> data.txt &gt; data
</span></code></pre>
<p>This output <code>data</code> file is now in it's original format and can be examined with <code>file data</code> to determine it's type.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>data: gzip compressed data, was &quot;data2.bin&quot;, last modified: Thu Sep 19 07:08:15 2024, max compression, from Unix, original size modulo 2^32 574
</span></code></pre>
<p>The result from <code>file</code> identifies it as "gzip compressed data". To decompress the archive, use the <code>gunzip</code> command.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout warning">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#warn"></use></svg>
    <div>Warning</div>
  </div>
  <div class="callout-text">
    <p>Be aware, that the archive utilities like <code>gunzip</code> may require particular file extensions when decompressing files. For example, <code>.gzip</code> or <code>.gz</code>. Otherwise you may get an error like this.</p>
<p><code>gzip: data: unknown suffix -- ignored</code></p>

  </div>
</div>


<style>
</style>
<p>To complete this challenge, you must repeat this process of decompressing or extracting data into a new format, then verifying the new format with <code>file</code> eight times to reach the original flag file content.</p>
<p>Below is a script describing each step of the decompression. You could run the script directly on the Bandit host to get the flag, but I encourage you to walk through each decompression step manually and observe the different flags being used for each command.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;">#!/bin/sh
</span><span style="color:#65737e;"># extract.sh
</span><span style="color:#bf616a;">xxd -r</span><span> data.txt &gt; f1.gz;    </span><span style="color:#65737e;"># extract first gzip archive from hexdump
</span><span style="color:#bf616a;">gunzip -c</span><span> f1.gz &gt; f2.bz2;   </span><span style="color:#65737e;"># extract bzip2 archive from f1.gz
</span><span style="color:#bf616a;">bunzip2 -c</span><span> f2.bz2 &gt; f3.gz;  </span><span style="color:#65737e;"># extract gzip archive from f2.bz2
</span><span style="color:#bf616a;">gunzip -c</span><span> f3.gz &gt; f4.tar;   </span><span style="color:#65737e;"># extract tar archive from f3.gz
</span><span style="color:#bf616a;">tar -xOf</span><span> f4.tar &gt; f5.tar;   </span><span style="color:#65737e;"># extract tar archive from f4.tar
</span><span style="color:#bf616a;">tar -xOf</span><span> f5.tar &gt; f6.bz2;   </span><span style="color:#65737e;"># extract bzip2 archive from f5.tar
</span><span style="color:#bf616a;">bunzip2 -c</span><span> f6.bz2 &gt; f7.tar; </span><span style="color:#65737e;"># extract tar archive from f6.bz2
</span><span style="color:#bf616a;">tar -xOf</span><span> f7.tar &gt; f8.gz;    </span><span style="color:#65737e;"># extract gzip archive from f7.tar
</span><span style="color:#bf616a;">gunzip -c</span><span> f8.gz &gt; flag;     </span><span style="color:#65737e;"># extract plaintext flag file from f8.gz
</span><span>
</span><span style="color:#bf616a;">cat</span><span> flag;
</span></code></pre>
<h3 id="level-13"><a class="zola-anchor" href="#level-13" aria-label="Anchor link for: level-13">Level 13</a></h3>
<blockquote>
<p>The password for the next level is stored in <code>/etc/bandit_pass/bandit14</code> and can only be read by user <code>bandit14</code>. For this level, you don’t get the next password, but you get a private SSH key that can be used to log into the next level.</p>
<p>Note: <code>localhost</code> is a hostname that refers to the machine you are working on</p>
</blockquote>
<h4 id="useful-commands-3"><a class="zola-anchor" href="#useful-commands-3" aria-label="Anchor link for: useful-commands-3">Useful commands 3</a></h4>
<p>Once again, OverTheWire has provided some new recommended commands to investigate.</p>
<table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/ssh.1.html">ssh</a></td><td>a program for logging into or executing commands on remote machines</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/telnet.1posix.html">telnet</a></td><td>communicate with another host using the TELNET protocol</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/nc.1.html">nc</a></td><td>the swiss army knife for communicating over the network using TCP, UDP, or Unix-domain sockets</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/openssl.1.html">openssl</a></td><td>a program for using various cryptography functions of the OpenSSL crypto library from the shell</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/openssl-s_client.1.html">s_client</a></td><td>a program implementing a generic SSL/TLS client</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/nmap.1.html">nmap</a></td><td>a network scanner for network exploration and security auditing</td></tr>
</tbody></table>
<p>Each program is worth exploring, but for this challenge we'll only need <code>ssh</code>. However, it won't be used quite the same as before. This time an SSH private key is required to login to the next level.</p>
<p>After logging in to <code>bandit13</code>, you should find the private SSH key mentioned in the prompt at <code>/home/bandit13/sshkey.private</code>. Copy that file to your primary host. You can simply copy paste the text if you wish, or use something like <a href="https://manpages.ubuntu.com/manpages/noble/en/man1/scp.1.html">scp</a>.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout warning">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#warn"></use></svg>
    <div>Warning</div>
  </div>
  <div class="callout-text">
    <p>Watch out! The <code>ssh</code> command requires private key files to have appropriate permissions. If they aren't correct you may receive an error message like this.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
</span><span>@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
</span><span>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
</span><span>Permissions 0644 for &#39;sshkey.private&#39; are too open.
</span><span>It is required that your private key files are NOT accessible by others.
</span><span>This private key will be ignored.
</span><span>Load key &quot;sshkey.private&quot;: bad permissions
</span></code></pre>
<hr />
<p><em>A brief reminder of the octal permissions.</em></p>
<table><thead><tr><th>Octal Number</th><th>Permission Type</th><th>Symbols</th></tr></thead><tbody>
<tr><td>0</td><td>No permissions</td><td>---</td></tr>
<tr><td>1</td><td>Execute</td><td>--x</td></tr>
<tr><td>2</td><td>Write</td><td>-w-</td></tr>
<tr><td>3</td><td>Write + Execute</td><td>-wx</td></tr>
<tr><td>4</td><td>Read</td><td>r--</td></tr>
<tr><td>5</td><td>Read + Execute</td><td>r-x</td></tr>
<tr><td>6</td><td>Read + Write</td><td>rw-</td></tr>
<tr><td>7</td><td>Read + Write + Execute</td><td>rwx</td></tr>
</tbody></table>
<p>As the error mentions, the permissions <code>0644</code> are too open. That's because private key files should only be readable and/or writeable by the user they belong to. Usually that means either <code>600</code> or <code>400</code>, though <code>400</code> is a bit strict and won't allow the file to edited.</p>
<p>So, setting the permissions to <code>600</code> would give the key file read and write access for the user, and no permissions for either the group or others.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">chmod</span><span> 600 sshkey.private
</span></code></pre>
<p>Now we're ready to connect to <code>bandit14</code>.</p>

  </div>
</div>


<style>
</style>
<p>To use a key file with <code>ssh</code>, the <code>-i</code> flag can be used.</p>
<p>E.g.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">ssh</span><span> user@host</span><span style="color:#bf616a;"> -i</span><span> private_key
</span></code></pre>
<p>To connect to <code>bandi14</code> use the following command.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">ssh</span><span> bandit14@bandit.labs.overthewire.org</span><span style="color:#bf616a;"> -p</span><span> 2220</span><span style="color:#bf616a;"> -i</span><span> sshkey.private
</span></code></pre>
<p>SSH is the most common protocol used for remotely administrating Linux and Unix-like systems, and using a key file as we've done here is by far the most common way it's used. It's not strictly necessary, but I highly recommend reading up on the fundamentals of <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public-key cryptography</a>. It's how SSH guarantees<sup class="footnote-reference" id="fr-1-1"><a href="#fn-1">1</a></sup> it's security.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout note">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#info"></use></svg>
    <div>Note</div>
  </div>
  <div class="callout-text">
    <p>In the solution above, we just used the <code>-i</code> flag to specify the private key file. However, anyone using <code>ssh</code> on a regular basis will rightly tell you to consider configuring ssh on your system for a much simpler workflow.</p>
<p>If you're connecting to many hosts via ssh, it is much more convenient to configure the <a href="https://manpages.ubuntu.com/manpages/noble/en/man1/ssh-agent.1.html">ssh-agent</a> to handle your ssh keys automatically so you don't need to specifiy the key file with the <code>-i</code> flag each time.</p>
<p>You may also want to combine this with host-specific configurations. This can be done with a <code>config</code> file usually at <code>~/.ssh/config</code>. Check out the <a href="https://manpages.ubuntu.com/manpages/noble/en/man5/ssh_config.5.html">ssh_config manual</a> for more details.</p>

  </div>
</div>


<style>
</style>
<h3 id="level-14"><a class="zola-anchor" href="#level-14" aria-label="Anchor link for: level-14">Level 14</a></h3>
<blockquote>
<p>The password for the next level can be retrieved by submitting the password of the current level to port 30000 on localhost.</p>
</blockquote>
<p>If you aren't familiar with IP addresses or ports, I highly encourage you to read the recommended reading material on the <a href="https://overthewire.org/wargames/bandit/bandit15.html#helpful-reading-material">Bandit 14 page</a>.</p>
<p>This time we need to connect to a particular port, but we won't be using the SSH protocol. Instead we need to send the current password as unencrypted text to port 30000 on localhost. The <code>nc</code> (netcat) utility can do just that.</p>
<p>Netcat establishes a connection with the following syntax:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">nc </span><span>&lt;destination&gt; &lt;port&gt;
</span></code></pre>
<ul>
<li>The <code>destination</code> can be any domain as long as it resolves to an IP address, or it can take an IP address directly.</li>
<li>The <code>port</code> corresponds to the TCP/UDP port.</li>
</ul>
<p>Now, connect with the parameters given in the prompt.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">netcat</span><span> localhost 30000
</span></code></pre>
<p>This will establish the connection, but won't provide a new terminal prompt. That's because the program you've connected to is now awaiting input. Provide the level 14 password and press <code>Enter</code>, and the level 15 password will be returned.</p>
<h3 id="level-15"><a class="zola-anchor" href="#level-15" aria-label="Anchor link for: level-15">Level 15</a></h3>
<blockquote>
<p>The password for the next level can be retrieved by submitting the password of the current level to port 30001 on localhost using SSL/TLS encryption.<br><br>Helpful note: Getting “DONE”, “RENEGOTIATING” or “KEYUPDATE”? Read the “CONNECTED COMMANDS” section in the manpage.</p>
</blockquote>
<p>Now, we've got another challenge asking us to connect to a port on localhost and submit the password, but this time, the password must be encrypted using SSL/TLS.</p>
<p>One of the recommended commands is <code>s_client</code> which is a generic SSL/TLS<sup class="footnote-reference" id="fr-2-1"><a href="#fn-2">2</a></sup> client. We'll need to use a couple flags, <code>-host</code>, and <code>-port</code>.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">openssl</span><span> s_client</span><span style="color:#bf616a;"> -host</span><span> localhost</span><span style="color:#bf616a;"> -port</span><span> 30001
</span></code></pre>
<p>It's actually possible to elide the <code>-host</code> flag since <code>s_client</code> connects to <code>localhost</code> by default.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">openssl</span><span> s_client</span><span style="color:#bf616a;"> -port</span><span> 30001
</span></code></pre>
<p>By default there, will be a fair amount of output describing the security parameters for the connection such as the certificate and handshake details.</p>
<p>Once the connection is established there should be a line at the bottom <code>read R BLOCK</code>. At this point the terminal is awaiting input. Provide the current password to receive the password for the next level.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>---
</span><span>read R BLOCK
</span><span>[REDACTED BANDIT 15 PASSWORD]
</span><span>Correct!
</span><span>[REDACTED BANDIT 16 PASSWORD]
</span><span>
</span><span>closed
</span></code></pre>
<h3 id="level-16"><a class="zola-anchor" href="#level-16" aria-label="Anchor link for: level-16">Level 16</a></h3>
<blockquote>
<p>The credentials for the next level can be retrieved by submitting the password of the current level to a port on localhost in the range 31000 to 32000. First find out which of these ports have a server listening on them. Then find out which of those speak SSL/TLS and which don’t. There is only 1 server that will give the next credentials, the others will simply send back to you whatever you send to it. <br><br>Helpful note: Getting “DONE”, “RENEGOTIATING” or “KEYUPDATE”? Read the “CONNECTED COMMANDS” section in the manpage.</p>
</blockquote>
<p>This challenge is almost identical to <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-15">Level 15</a>. However, this time we are not given the appropriate port. Instead, we're only given a range of suspect ports. To identify the services running on these TCP/UDP ports, we can use the <code>nmap</code> program.</p>
<p><a href="https://nmap.org/docs.html">Nmap</a> is a network scanning tool which is often used to automatically enumerate devices and ports in a network. In our case, we're only interested in ports on the Bandit host, or in other words the <a href="https://en.wikipedia.org/wiki/Localhost">localhost</a>.</p>
<p>To scan all the ports in the given range on <code>localhost</code> we'll run an <a href="https://explainshell.com/explain?cmd=nmap+localhost+-p31000-32000">nmap command</a>.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">nmap</span><span> localhost</span><span style="color:#bf616a;"> -p31000-32000
</span></code></pre>
<p>This should return the following:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-29 20:28 UTC
</span><span>Nmap scan report for localhost (127.0.0.1)
</span><span>Host is up (0.00017s latency).
</span><span>Not shown: 996 closed tcp ports (conn-refused)
</span><span>PORT      STATE SERVICE
</span><span>31046/tcp open  unknown
</span><span>31518/tcp open  unknown
</span><span>31691/tcp open  unknown
</span><span>31790/tcp open  unknown
</span><span>31960/tcp open  unknown
</span><span>
</span><span>Nmap done: 1 IP address (1 host up) scanned in 0.18 seconds
</span></code></pre>
<p>This scan results in just a few open ports. Given such a short list, one option is to attempt communication on each port to see which one speaks SSL/TLS. However, if there were many more open ports, it would make more sense to automate that detection with <code>nmap</code>. Luckily this is possible with just one flag <code>-sV</code> which can be found under the <code>SERVICE/VERSION DETECTION</code> section in the <a href="https://linux.die.net/man/1/nmap">manpage</a>.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">nmap</span><span> localhost</span><span style="color:#bf616a;"> -p31000-32000
</span></code></pre>
<p>This version of the command will take a bit longer since <code>nmap</code> must analyze the traffic on each open port to determine what service may be running. The output should look something like this.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-29 21:11 UTC
</span><span>Nmap scan report for localhost (127.0.0.1)
</span><span>Host is up (0.00018s latency).
</span><span>Not shown: 996 closed tcp ports (conn-refused)
</span><span>PORT      STATE SERVICE     VERSION
</span><mark style="background-color:#65737e30;"><span>31046/tcp open  echo
</span></mark><mark style="background-color:#65737e30;"><span>31518/tcp open  ssl/echo
</span></mark><mark style="background-color:#65737e30;"><span>31691/tcp open  echo
</span></mark><mark style="background-color:#65737e30;"><span>31790/tcp open  ssl/unknown
</span></mark><mark style="background-color:#65737e30;"><span>31960/tcp open  echo
</span></mark><span>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span><span>SF-Port31790-TCP:V=7.94SVN%T=SSL%I=7%D=5/29%Time=6838CD8E%P=x86_64-pc-linu
</span><span>SF:x-gnu%r(GenericLines,32,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x2
</span><span>SF:0current\x20password\.\n&quot;)%r(GetRequest,32,&quot;Wrong!\x20Please\x20enter\x
</span><span>SF:20the\x20correct\x20current\x20password\.\n&quot;)%r(HTTPOptions,32,&quot;Wrong!\
</span><span>SF:x20Please\x20enter\x20the\x20correct\x20current\x20password\.\n&quot;)%r(RTS
</span><span>SF:PRequest,32,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20
</span><span>SF:password\.\n&quot;)%r(Help,32,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x
</span><span>SF:20current\x20password\.\n&quot;)%r(FourOhFourRequest,32,&quot;Wrong!\x20Please\x2
</span><span>SF:0enter\x20the\x20correct\x20current\x20password\.\n&quot;)%r(LPDString,32,&quot;W
</span><span>SF:rong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\.\n&quot;)
</span><span>SF:%r(SIPOptions,32,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20curren
</span><span>SF:t\x20password\.\n&quot;);
</span><span>
</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span><span>Nmap done: 1 IP address (1 host up) scanned in 155.35 seconds
</span></code></pre>
<p>Here we have the same open ports as before, but this time, with some additional version information. You'll notice that SSL/TLS responses were only detected on ports <code>31518</code> with <code>ssl/echo</code> and <code>31790</code> with <code>ssl/unknown</code>. The <code>ssl/echo</code> is just a simple echo service like the others, except that it is served via SSL/TLS, which only leaves the remaining <code>ssl/unknown</code> service. You can actually see the initial text sent and received by <code>nmap</code> when analyzing port <code>31790</code>. It seems to include several failed password attempts.</p>
<p>Just as in <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-15">Level 15</a>, we can use the following OpenSSL command to start an SSL/TLS connection with our target port.</p>
<p>After the initial connection is established, the program awaits some user input which requires the password to the current level.</p>
<p>Once the password is entered, it's possible that the service does not immediately reply with the credentials for the next level. As mentioned in the prompt, if there is a response including "DONE", "RENEGOTIATING", or "KEYUPDATE" then you may need to check the "CONNECTED COMMANDS" section of the <a href="https://docs.openssl.org/master/man1/openssl-s_client/">openssl-s_client</a> manpage.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>CONNECTED COMMANDS (BASIC)
</span><span>       If  a connection is established with an SSL/TLS server then any data received from the server
</span><span>       is displayed and any key presses will be sent to the server. If end of file is  reached  then
</span><span>       the connection will be closed down.
</span><span>
</span><mark style="background-color:#65737e30;"><span>       When  used  interactively  (which  means  neither  -quiet  nor -ign_eof have been given), and
</span></mark><mark style="background-color:#65737e30;"><span>       neither of -adv or -nocommands are given then &quot;Basic&quot; command mode is entered. In  this  mode
</span></mark><mark style="background-color:#65737e30;"><span>       certain commands are recognized which perform special operations. These commands are a letter
</span></mark><mark style="background-color:#65737e30;"><span>       which  must  appear  at the start of a line. All further data after the initial letter on the
</span></mark><mark style="background-color:#65737e30;"><span>       line is ignored.  The commands are listed below.
</span></mark><span>
</span><span>       Q   End the current SSL connection and exit.
</span><span>
</span><span>       R   Renegotiate the SSL session (TLSv1.2 and below only).
</span><span>
</span><span>       C   Attempt to reconnect to the server using a resumption handshake.
</span><span>
</span><mark style="background-color:#65737e30;"><span>       k   Send a key update message to the server (TLSv1.3 only)
</span></mark><span>
</span><span>       K   Send a key update message to the server and request one back (TLSv1.3 only)
</span></code></pre>
<p>In my case, I received a "KEYUPDATE" response because the password I used begins with a "k".</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>--- snip ---
</span><span>read R BLOCK
</span><span>[REDACTED LEVEL 15 PASSWORD]
</span><span>KEYUPDATE
</span></code></pre>
<p>Since I didn't provide any of the <code>-quiet</code>, <code>-ign_eof</code>, <code>-adv</code>, or <code>-nocommands</code> flags, the connection entered the "Basic" command mode which uses the first character in the next line of input to determine which command to execute.</p>
<p>To prevent this "Basic" mode from clobbering our input we need use one of these flags. For example.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>openssl s_client -connect localhost:31790 -nocommands
</span></code></pre>
<p>Which should return the following.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>--- snip ---
</span><span>read R BLOCK
</span><span>[REDACTED LEVEL 16 PASSWORD]
</span><span>Correct!
</span><span>-----BEGIN RSA PRIVATE KEY-----
</span><span>[REDACTED RSA KEY]
</span><span>-----END RSA PRIVATE KEY-----
</span><span>
</span><span>closed
</span></code></pre>
<p>This time, the service accepts the password and replies with an RSA key to access the next level and closes the connection.</p>
<h3 id="level-17"><a class="zola-anchor" href="#level-17" aria-label="Anchor link for: level-17">Level 17</a></h3>
<blockquote>
<p>There are 2 files in the homedirectory: <code>passwords.old</code> and <code>passwords.new</code>. The password for the next level is in <code>passwords.new</code> and is the only line that has been changed between <code>passwords.old</code> and <code>passwords.new</code></p>
<p>NOTE: if you have solved this level and see ‘Byebye!’ when trying to log into bandit18, this is related to the next level, bandit19</p>
</blockquote>
<p>This level wants us to find any <strong>diff</strong>erences between the <code>passwords.old</code> and <code>passwords.new</code> files. One of the recommended commands is <a href="https://linux.die.net/man/1/diff">diff</a> which has the sole purpose of comparing files line by line and displaying the differences.</p>
<p>Let's get a diff of our two password files.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ diff passwords.old passwords.new
</span></code></pre>
<pre data-lang="diff" style="background-color:#2b303b;color:#c0c5ce;" class="language-diff "><code class="language-diff" data-lang="diff"><span>42c42
</span><span style="color:#bf616a;">&lt; C6XNBdYOkgt5ARXESMKWWOUwBeaIQZ0Y
</span><span style="background-color:#4f5b66;color:#c0c5ce;">---
</span><span style="color:#a3be8c;">&gt; [REDACTED LEVEL 18 PASSWORD]
</span></code></pre>
<p>The first line indicates which lines were changed. In this case a change has been identified in line 42 of both files. The lines above the <code>---</code> separator are the changes made in the file that was input as the first argument (<code>passwords.old</code>), while the lines under the <code>---</code> correspond to the second argument (<code>password.new</code>).</p>
<p>We can see the password for level 18 highlighted in green.</p>
<h3 id="level-18"><a class="zola-anchor" href="#level-18" aria-label="Anchor link for: level-18">Level 18</a></h3>
<blockquote>
<p>The password for the next level is stored in a file <code>readme</code> in the homedirectory. Unfortunately, someone has modified <code>.bashrc</code> to log you out when you log in with SSH.</p>
</blockquote>
<p>While <code>ssh</code> is primarily used for starting a user shell on a remote host, commands can actually be executed directly without starting a new shell. The SYNOPSIS of the <a href="https://linux.die.net/man/1/ssh">ssh manpage</a> shows the necessary syntax.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>SYNOPSIS
</span><span>       ssh   [-46AaCfGgKkMNnqsTtVvXxYy]  [-B  bind_interface]  [-b  bind_address]  [-c  cipher_spec]
</span><span>           [-D [bind_address:]port] [-E log_file]  [-e  escape_char]  [-F  configfile]  [-I  pkcs11]
</span><span>           [-i   identity_file]   [-J  destination]  [-L  address]  [-l  login_name]  [-m  mac_spec]
</span><span>           [-O ctl_cmd] [-o option] [-P tag] [-p port] [-R address]  [-S  ctl_path]  [-W  host:port]
</span><mark style="background-color:#65737e30;"><span>           [-w local_tun[:remote_tun]] destination [command [argument ...]]
</span></mark><span>       ssh [-Q query_option]
</span></code></pre>
<p>After the required <code>destination</code> parameter you can see the optional <code>[command [argument ...]]</code> parameter. Any commands provided here will be executed on the remote host.</p>
<p>So the command to output the password in the remote host's <code>readme</code> file should look like this.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ssh bandit18@bandit.labs.overthewire.org cat readme
</span><span>                         _                     _ _ _
</span><span>                        | |__   __ _ _ __   __| (_) |_
</span><span>                        | &#39;_ \ / _` | &#39;_ \ / _` | | __|
</span><span>                        | |_) | (_| | | | | (_| | | |_
</span><span>                        |_.__/ \__,_|_| |_|\__,_|_|\__|
</span><span>
</span><span>
</span><span>                      This is an OverTheWire game server.
</span><span>            More information on http://www.overthewire.org/wargames
</span><span>
</span><span>bandit18@bandit.labs.overthewire.org&#39;s password:
</span><mark style="background-color:#65737e30;"><span>[REDACTED LEVEL 18 PASSWORD]
</span></mark></code></pre>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout note">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#info"></use></svg>
    <div>Note</div>
  </div>
  <div class="callout-text">
    <p>This command should be executed from your own system, not from the system hosting Bandit i.e. while logged into one of the previous levels.</p>
<p>I've configured my SSH client to automatically use port <code>2220</code> as required for the Bandit wargame which is why I haven't explicitly provided the port in this example. To do the same, add the following line to your <code>~/.ssh/config</code> file or provide the port number via the <code>-p</code> flag.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Host bandit.labs.overthewire.org
</span><span>    port 2220
</span></code></pre>

  </div>
</div>


<style>
</style>
<h3 id="level-19"><a class="zola-anchor" href="#level-19" aria-label="Anchor link for: level-19">Level 19</a></h3>
<blockquote>
<p>To gain access to the next level, you should use the <code>setuid</code> binary in the homedirectory. Execute it without arguments to find out how to use it. The password for this level can be found in the usual place (<code>/etc/bandit_pass</code>), after you have used the <code>setuid</code> binary.</p>
</blockquote>
<p>First let's define a few terms.</p>
<table><thead><tr><th>Term</th><th>Descriptions</th></tr></thead><tbody>
<tr><td>Real User ID (RUID)</td><td>The ID of the user which started a process</td></tr>
<tr><td>Effective User ID (EUID)</td><td>The ID of the user which defines the privileges of a running process.</td></tr>
<tr><td><a href="https://en.wikipedia.org/wiki/Setuid#SUID">suid permission bit</a></td><td>A special file permission bit besides the standard read (r), write (w), and execute (x) that allows a file to be executed as the owner of that file</td></tr>
</tbody></table>
<p>For the <code>bandit20-do</code> permissions the <code>suid</code> bit can be seen as the <code>s</code> in the execute position of the user permissions.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ls -l
</span><span>total 16
</span><mark style="background-color:#65737e30;"><span>-rwsr-x--- 1 bandit20 bandit19 14884 Apr 10 14:23 bandit20-do
</span></mark></code></pre>
<p>The special (suid) permission is set and the owner of the file is <code>bandit20</code>, thus allowing the binary access to resources available to the user <code>bandit20</code>.</p>
<p>By default, the effective user ID matches the real user ID. However, If you execute the provided binary without any arguments some usage information will be returned.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ./bandit20-do
</span><span>Run a command as another user.
</span><span>  Example: ./bandit20-do id
</span></code></pre>
<p>Note that the <a href="https://www.man7.org/linux/man-pages/man1/id.1.html">id</a> command will show the real and effective user and group IDs for the current user's shell unless provided with an argument. Now, let's run that example.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ./bandit20-do id
</span><span>uid=11019(bandit19) gid=11019(bandit19) euid=11020(bandit20) groups=11019(bandit19)
</span></code></pre>
<p>See how it differs from running the plain <code>id</code> command run as the <code>bandit19</code> user.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ id
</span><span>uid=11019(bandit19) gid=11019(bandit19) groups=11019(bandit19)
</span></code></pre>
<p>An additional item is returned from the <code>bandit20-do</code> invocation, the <em>effective</em> user ID <code>euid=11020(bandit20)</code>. This indicates that the commands run via <code>bandit20-d0</code> should be able to access files available to the <code>bandit20</code> user. Which includes the password file.</p>
<p>As long as we know its location which was provided as <code>/etc/bandit_pass/bandit20</code> we can simply output the file. So, solving this challenge is actually quite simple. Execute a <code>cat</code> command with the password file as an argument via the <code>bandit20-do</code> binary like so:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ./bandit20-do cat /etc/bandit_pass/bandit20
</span><span>[REDACTED BANDIT 20 PASSWORD]
</span></code></pre>
<h3 id="level-20"><a class="zola-anchor" href="#level-20" aria-label="Anchor link for: level-20">Level 20</a></h3>
<blockquote>
<p>There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).</p>
<p>NOTE: Try connecting to your own network daemon to see if it works as you think</p>
</blockquote>
<h4 id="useful-commands-4"><a class="zola-anchor" href="#useful-commands-4" aria-label="Anchor link for: useful-commands-4">Useful commands 4</a></h4>
<p>This challenge recommends some new commands that we haven't seen so far.</p>
<table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/screen.1.html">screen</a></td><td>a terminal multiplexer</td></tr>
<tr><td><a href="https://manpages.ubuntu.com/manpages/noble/man1/tmux.1.html">tmux</a></td><td>a terminal multiplexer</td></tr>
<tr><td><a href="https://www.man7.org/linux/man-pages/man1/jobs.1p.html">jobs</a></td><td>display the status of all jobs in the current session</td></tr>
<tr><td><a href="https://www.man7.org/linux/man-pages/man1/bg.1p.html">bg</a></td><td>send a running job to the background</td></tr>
<tr><td><a href="https://www.man7.org/linux/man-pages/man1/fg.1p.html">fg</a></td><td>bring a backgrounded job to the foreground</td></tr>
</tbody></table>
<p>These programs introduce some new concepts that are pretty important for anyone working on Linux system whether as a user or an administrator. Let's briefly go over them.</p>
<h4 id="job-control"><a class="zola-anchor" href="#job-control" aria-label="Anchor link for: job-control">Job control</a></h4>
<p>You can read more about it in the <a href="https://www.gnu.org/software/bash/manual/html_node/Job-Control.html">Job Control section</a> of the <a href="https://www.gnu.org/software/bash/manual/html_node/index.html">Bash Reference Manual</a>. But, to summarize, job control, is a system for suspending and resuming processes and allowing them to run in the <em>background</em> such that the user can continue executing other commands without waiting for previous commands to complete.</p>
<p>To interact with the job control system, we have a few tools including: the <code>jobs</code>, <code>bg</code>, and <code>fg</code> commands as well as the <code>&amp;</code> character, and the <kbd>Ctrl+Z</kbd> keyboard shortcut which you may see referred to as the suspend character or <code>^Z</code>.</p>
<p>We generally use two methods to run a program in the <em>background</em>. The first is to execute a command with an <code>&amp;</code> at the end of the line.</p>
<p>For example</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat - &amp;
</span><span>[1] 1809443
</span></code></pre>
<p>The <code>cat</code> process has been added to the jobs list and is now in the background.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ jobs
</span><span>[1]+  Stopped                 cat -
</span></code></pre>
<p>As you can see when listing the available jobs, the command has been <em>Stopped</em> which indicates that is has been suspended and is no longer running. However, we can bring this process back to the foreground so that we can interact with it again using the <code>fg</code> command.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ fg
</span><span>cat -
</span><span>hello
</span><span>hello
</span></code></pre>
<p>Besides starting a command with the <code>&amp;</code>, we can also use the <kbd>Ctrl+Z</kbd> keyboard shortcut to send an already running process to the background. Let's send the <code>cat</code> process to the background once again.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>^Z
</span><span>[1]+  Stopped                 cat -
</span><span>$ jobs
</span><span>[1]+  Stopped                 cat -
</span></code></pre>
<p>You can see here we've once again stopped the process running <code>cat</code> and returned it to the background. The <code>^Z</code> indicates the pressing of <kbd>Ctrl+Z</kbd>. Be aware though, that backgrounding a process in this manner will also stop the process. To let it continue running in that background you must use the <code>bg</code> command.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ bg %1
</span><span>[1]+ cat - &amp;
</span><span>
</span><span>[1]+  Stopped                 cat -
</span></code></pre>
<p>Here we used what's known as a job specification or job spec to identify the job with a <code>%</code> followed by the ID of 1 which you may need to do if you have several backgrounded jobs. In this little example, since the <code>cat</code> process is awaiting user input, it's immediately stopped again after telling it to run in the background. However, a longer running process would continue until the program exits or is awaiting more user input.</p>
<h4 id="terminal-multiplexing"><a class="zola-anchor" href="#terminal-multiplexing" aria-label="Anchor link for: terminal-multiplexing">Terminal multiplexing</a></h4>
<p>Both <code>tmux</code> and <code>screen</code> are terminal multiplexers. Which just means they can display multiple terminals within a single window. They allow you to split these windows as needed and can allow grouping terminals, copying and pasting etc. This can all be done from the command line with these tool, which is why they're useful when working over a remote SSH session.</p>
<p>There are also GUI-based alternatives. Terminal emulators like <a href="https://gnome-terminator.org">Terminator</a>, <a href="https://konsole.kde.org">Konsole</a>, and even <a href="https://github.com/microsoft/terminal">Windows Terminal</a> ship with multiplexing features, but I won't go into too much detail here. I recommend you try out whichever ones work for your system and see what you like best. Just know that only the terminal-based multiplexers like <code>tmux</code> and <code>screen</code> will enable you to use multiple terminals on a remote system without initiating an additional SSH session.</p>
<h4 id="solution"><a class="zola-anchor" href="#solution" aria-label="Anchor link for: solution">Solution</a></h4>
<p>This challenge provides another <code>setuid</code> binary, just how <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-19">Level 19</a> did. Checking the permissions shows that this binary also has the <code>suid</code> bit set with an owner of <code>bandit21</code>, so it should be able to read the <code>bandit21</code> password file for us in some way.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ls -l
</span><span>total 16
</span><span>-rwsr-x--- 1 bandit21 bandit20 15608 Apr 10 14:23 suconnect
</span></code></pre>
<p>First off, let's check the usage information for <code>suconnect</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ./suconnect
</span><span>Usage: ./suconnect &lt;portnumber&gt;
</span><span>This program will connect to the given port on localhost using TCP. If it receives the correct password from the other side, the next password is transmitted back.
</span></code></pre>
<p>For this walkthrough we'll use the job control method.</p>
<p>First, we need to setup a TCP listener on a high port<sup class="footnote-reference" id="fr-3-1"><a href="#fn-3">3</a></sup> for the <code>suconnect</code> binary to connect to. The simplest way to do this is with the <code>netcat</code> utility which we've <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-14">used before</a>.</p>
<p>Here we run netcat in listening mode and specify port <code>9898</code>, but importantly we've provided the <code>&amp;</code> at the end of the line to send the process to the background.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ nc -l -p 9898 &amp;
</span><span>[1] 744373
</span></code></pre>
<p>Running the <code>jobs</code> command will list the active jobs which now includes the <code>netcat</code> command we just launched. As you can see it's still running since it's awaiting a connection.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ jobs
</span><span>[1]+  Running                 nc -l -p 9898 &amp;
</span></code></pre>
<p>Next we need to run the <code>suconnect</code> binary and connect to the same port, <code>9898</code>. We also execute this command as a background job.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ./suconnect 9898 &amp;
</span><span>[2] 913657
</span></code></pre>
<p>The jobs list now contains both of our programs running in the background.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ jobs
</span><span>[1]+  Stopped                 nc -l -p 9898
</span><span>[2]-  Running                 ./suconnect 9898 &amp;
</span></code></pre>
<p>You can see that the <code>netcat</code> command has been stopped, but we can start it again by bringing it into the foreground with the <code>fg</code> command to interact with it. Note that since the <code>netcat</code> job has the <code>+</code> indicator it will be selected by default, but we can also specify the specific job to bring to the foreground with it's job number.</p>
<p>Once you bring the <code>netcat</code> job to the foreground, the terminal will once again be awaiting input. Provide the level 20 password as the prompt informed us.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ fg %1
</span><span>nc -l -p 9898
</span><span>[REDACTED LEVEL 20 PASSWORD]
</span><span>Read: [REDACTED LEVEL 20 PASSWORD]
</span><mark style="background-color:#65737e30;"><span>Password matches, sending next password
</span></mark><mark style="background-color:#65737e30;"><span>[REDACTED LEVEL 21 Password]
</span></mark><span>[2]+  Done                    ./suconnect 9898
</span></code></pre>
<p>As you can see, <code>suconnect</code> accepted the level 20 password and replied with the password for level 21. We can also see that the job for <code>suconnect</code> completed and exited normally by the <code>Done</code> response in the final line.</p>
<h3 id="level-21"><a class="zola-anchor" href="#level-21" aria-label="Anchor link for: level-21">Level 21</a></h3>
<p>A program is running automatically at regular intervals from <code>cron</code>, the time-based job scheduler. Look in <code>/etc/cron.d/</code> for the configuration and see what command is being executed.</p>
<p>The prompt also recommends some useful manpages.</p>
<h4 id="cron"><a class="zola-anchor" href="#cron" aria-label="Anchor link for: cron">Cron</a></h4>
<table><thead><tr><th>Manpage</th><th>Description</th></tr></thead><tbody>
<tr><td><kbd><a href="https://www.man7.org/linux/man-pages/man8/cron.8.html">cron(8)</a></kbd></td><td>system for scheduling commands</td></tr>
<tr><td><kbd><a href="https://man7.org/linux/man-pages/man1/crontab.1.html">crontab(1)</a></kbd></td><td>manage crontab files for a user</td></tr>
<tr><td><kbd><a href="https://man7.org/linux/man-pages/man5/crontab.5.html">crontab(5)</a></kbd></td><td>crontab file format and syntax</td></tr>
</tbody></table>
<p>Cron is a system for executing commands at regular intervals. This is a very common task for system administrators. Whether a task involves performing regular backups of data or generate reports automatically.</p>
<p><a href="https://crontab.guru">Contab guru</a> is a convenient tool to parse crontabs if you're unfamiliar with the syntax or want to verify the correctness of your own crontabs.</p>
<h4 id="solution-1"><a class="zola-anchor" href="#solution-1" aria-label="Anchor link for: solution-1">Solution</a></h4>
<p>The prompt points us to the configuration files in <code>/etc/cron.d</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ls -l
</span><span>total 28
</span><span>-rw-r--r-- 1 root root 123 Apr 10 14:16 clean_tmp
</span><span>-rw-r--r-- 1 root root 120 Apr 10 14:23 cronjob_bandit22
</span><span>-rw-r--r-- 1 root root 122 Apr 10 14:23 cronjob_bandit23
</span><span>-rw-r--r-- 1 root root 120 Apr 10 14:23 cronjob_bandit24
</span><span>-rw-r--r-- 1 root root 201 Apr  8  2024 e2scrub_all
</span><span>-rwx------ 1 root root  52 Apr 10 14:24 otw-tmp-dir
</span><span>-rw-r--r-- 1 root root 396 Jan  9  2024 sysstat
</span></code></pre>
<p>Checking the contents of the <code>cronjob_bandit22</code> file reveals a specification for two cron jobs.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
</span><span>* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
</span></code></pre>
<p>The first line runs the <code>cronjob_bandit22.sh</code> script at boot time, and the second line runs the same script every minute.</p>
<p>Let's see what that script does.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;">#!/bin/bash
</span><span style="color:#bf616a;">chmod</span><span> 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</span><span style="color:#bf616a;">cat</span><span> /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</span></code></pre>
<p>According to this script, the password for <code>bandit22</code> seems to be written to the file <code>/tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv</code>. Reading that file will reveal the password.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</span><span>[REDACTED LEVEL 22 PASSWORD]
</span></code></pre>
<h3 id="level-22"><a class="zola-anchor" href="#level-22" aria-label="Anchor link for: level-22">Level 22</a></h3>
<blockquote>
<p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in <code>/etc/cron.d/</code> for the configuration and see what command is being executed.</p>
<p>NOTE: Looking at shell scripts written by other people is a very useful skill. The script for this level is intentionally made easy to read. If you are having problems understanding what it does, try executing it to see the debug information it prints.</p>
</blockquote>
<p>This level once again involves Cron. You may remember, from <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-21">Level 21</a> that there were a few other cron files in <code>/etc/cron.d</code>.</p>
<p>This time we're interested in the <code>/etc/cron.d/cronjob_bandit22</code> file.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
</span><span>* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
</span></code></pre>
<p>Once again this crontab points to a script in <code>/usr/bin</code>.</p>
<pre data-linenos data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><table><tbody><tr><td>1</td><td><span style="color:#65737e;">#!/bin/bash
</span></td></tr><tr><td>2</td><td><span style="color:#bf616a;">myname</span><span>=$</span><span style="color:#a3be8c;">(</span><span style="color:#bf616a;">whoami</span><span style="color:#a3be8c;">)
</span></td></tr><tr><td>3</td><td><span style="color:#bf616a;">mytarget</span><span>=$</span><span style="color:#a3be8c;">(</span><span style="color:#96b5b4;">echo</span><span style="color:#a3be8c;"> I am user </span><span>$</span><span style="color:#bf616a;">myname </span><span>| </span><span style="color:#bf616a;">md5sum </span><span>| </span><span style="color:#bf616a;">cut -d </span><span>&#39; &#39;</span><span style="color:#bf616a;"> -f</span><span style="color:#a3be8c;"> 1)
</span></td></tr><tr><td>4</td><td><span>
</span></td></tr><tr><td>5</td><td><span style="color:#96b5b4;">echo </span><span>&quot;</span><span style="color:#a3be8c;">Copying passwordfile /etc/bandit_pass/</span><span>$</span><span style="color:#bf616a;">myname</span><span style="color:#a3be8c;"> to /tmp/</span><span>$</span><span style="color:#bf616a;">mytarget</span><span>&quot;
</span></td></tr><tr><td>6</td><td><span>
</span></td></tr><tr><td>7</td><td><span style="color:#bf616a;">cat</span><span> /etc/bandit_pass/$</span><span style="color:#bf616a;">myname </span><span>&gt; /tmp/$</span><span style="color:#bf616a;">mytarget
</span></td></tr></tbody></table></code></pre>
<p>This script is quite similar to the script in <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-21">Level 21</a> except it's now using a variable, <code>mytarget</code> to store the target directory. And, instead of using a hardcoded location, the <code>mytarget</code> is built with a series of commands.</p>
<p>However, be aware that the <code>$myname</code> variable is being populated when the script runs as the <code>bandit23</code> user. So you can't use the results of <code>whoami</code> in the current shell for the <code>$myname</code> variable since that resolves to <code>bandit22</code>. Instead, the <code>$myname</code> variable should be <code>bandit23</code>. Replace it in the command line, like so, to calculate the correct location for the password.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#96b5b4;">echo</span><span> I am user bandit23 | </span><span style="color:#bf616a;">md5sum </span><span>| </span><span style="color:#bf616a;">cut -d </span><span>&#39; &#39;</span><span style="color:#bf616a;"> -f</span><span> 1
</span></code></pre>
<p>Running this series of commands will give us the value stored in <code>$mytarget</code> which is <code>8ca319486bfbbc3663ea0fbe81326349</code>. Therefore, the final location for the password is <code>/tmp/8ca319486bfbbc3663ea0fbe81326349</code>. Output the file to get the password.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349
</span><span>[REDACTED BANDIT 23 PASSWORD]
</span></code></pre>
<h3 id="level-23"><a class="zola-anchor" href="#level-23" aria-label="Anchor link for: level-23">Level 23</a></h3>
<blockquote>
<p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in <code>/etc/cron.d/</code> for the configuration and see what command is being executed.</p>
<p>NOTE: This level requires you to create your own first shell-script. This is a very big step and you should be proud of yourself when you beat this level!</p>
<p>NOTE 2: Keep in mind that your shell script is removed once executed, so you may want to keep a copy around…</p>
</blockquote>
<p>This challenge is similar to the last one, but this time we won't <em>just</em> be reading a shell script. We'll be writing out own.</p>
<h4 id="shell-scripting"><a class="zola-anchor" href="#shell-scripting" aria-label="Anchor link for: shell-scripting">Shell scripting</a></h4>
<p>We mostly breezed by all the scripts in the previous levels, but now that we're writing our own. Let's break them down a bit.</p>
<p>First we'll look at the anatomy of a shell script. Shell scripts are just text files. On Linux, file extensions in Linux usually<sup class="footnote-reference" id="fr-4-1"><a href="#fn-4">4</a></sup> aren't necessary, but it's common to end shell scripts with a <code>.sh</code> e.g. <code>shell.sh</code>.</p>
<p>The first line of any script should include a <a href="https://en.wikipedia.org/wiki/Shebang_%28Unix%29">shebang</a> to specify what kind of script it is. When a file starting with a shebang is executed, the filepath provided after the shebang points the interpreter that will be used for the script.</p>
<p>For example, a shell script might begin like so.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;">#!/bin/bash
</span><span style="color:#96b5b4;">echo</span><span> Hello there!
</span></code></pre>
<p>But it's also possible to indicate other types of scripts, like Python for example.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;">#!/usr/bin/python
</span><span style="color:#96b5b4;">print</span><span>(&quot;</span><span style="color:#a3be8c;">Hi!</span><span>&quot;)
</span></code></pre>
<p>We'll only be writing shell scripts in this walkthrough though.</p>
<p>After the shebang, you can write any command as you'd normally write directly in the terminal. For example, here's a script making a directory and writing some text to a file in that directory.</p>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#65737e;">#!/bin/sh
</span><span style="color:#bf616a;">mkdir -p</span><span> test_dir
</span><span style="color:#96b5b4;">echo </span><span>&quot;</span><span style="color:#a3be8c;">TESTING</span><span>&quot; &gt; test_dir/test.txt
</span><span style="color:#bf616a;">cat</span><span> test_dir/test.txt
</span></code></pre>
<p>There's a lot more to Bash and shell scripting, but this should be enough to get started. If you'd like to learn more, the <a href="https://www.gnu.org/software/bash/manual/bash.html">Bash Reference Manual</a> is an excellent reference.</p>
<p>If you're planning to do any real work with Bash scripts, definitely read through the <a href="https://jvns.ca/blog/2017/03/26/bash-quirks/">Bash scripting quirks &amp; safety tips</a> article by Julia Evans. It'll walk you through some of the common gotchas.</p>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout warning">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#warn"></use></svg>
    <div>Warning</div>
  </div>
  <div class="callout-text">
    <p>Don't forget to make any script you write executable. On most systems files aren't created with the execute (x) permission. So you'll need to modify the permissions with a command like <code>chmod +x</code>. This will enable any user to execute the script.</p>

  </div>
</div>


<style>
</style>
<h4 id="solution-2"><a class="zola-anchor" href="#solution-2" aria-label="Anchor link for: solution-2">Solution</a></h4>
<p>Now let's write our script.</p>
<p>We know that <code>bandit24</code> has a cronjob running. You'll find it at <code>/etc/cron.d/cronjob_bandit24</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>@reboot bandit24 /usr/bin/cronjob_bandit24.sh  &amp;&gt; /dev/null
</span><span>* * * * * bandit24 /usr/bin/cronjob_bandit24.sh  &amp;&gt; /dev/null
</span></code></pre>
<p>Just like the last level, the cronjob is executing a script in <code>/usr/bin</code>. Let's examine it.</p>
<pre data-linenos data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><table><tbody><tr><td>1</td><td><span style="color:#65737e;">#!/bin/bash
</span></td></tr><tr><td>2</td><td><span>
</span></td></tr><tr><td>3</td><td><span style="color:#bf616a;">myname</span><span>=$</span><span style="color:#a3be8c;">(</span><span style="color:#bf616a;">whoami</span><span style="color:#a3be8c;">)
</span></td></tr><tr><td>4</td><td><span>
</span></td></tr><tr><td>5</td><td><span style="color:#96b5b4;">cd</span><span> /var/spool/$</span><span style="color:#bf616a;">myname</span><span>/foo
</span></td></tr><tr><td><mark style="background-color:#65737e30;">6</mark></td><td><mark style="background-color:#65737e30;"><span style="color:#96b5b4;">echo </span><span>&quot;</span><span style="color:#a3be8c;">Executing and deleting all scripts in /var/spool/</span><span>$</span><span style="color:#bf616a;">myname</span><span style="color:#a3be8c;">/foo:</span><span>&quot;
</span></mark></td></tr><tr><td>7</td><td><span style="color:#b48ead;">for</span><span> i </span><span style="color:#b48ead;">in </span><span>* .*;
</span></td></tr><tr><td>8</td><td><span style="color:#b48ead;">do
</span></td></tr><tr><td>9</td><td><span>    </span><span style="color:#b48ead;">if </span><span style="color:#96b5b4;">[ </span><span>&quot;$</span><span style="color:#bf616a;">i</span><span>&quot; != &quot;</span><span style="color:#a3be8c;">.</span><span>&quot; </span><span style="color:#bf616a;">-a </span><span>&quot;$</span><span style="color:#bf616a;">i</span><span>&quot; != &quot;</span><span style="color:#a3be8c;">..</span><span>&quot; </span><span style="color:#96b5b4;">]</span><span>;
</span></td></tr><tr><td>10</td><td><span>    </span><span style="color:#b48ead;">then
</span></td></tr><tr><td>11</td><td><span>        </span><span style="color:#96b5b4;">echo </span><span>&quot;</span><span style="color:#a3be8c;">Handling </span><span>$</span><span style="color:#bf616a;">i</span><span>&quot;
</span></td></tr><tr><td>12</td><td><span>        </span><span style="color:#bf616a;">owner</span><span>=&quot;$</span><span style="color:#a3be8c;">(</span><span style="color:#bf616a;">stat --format </span><span>&quot;</span><span style="color:#a3be8c;">%U</span><span>&quot;</span><span style="color:#a3be8c;"> ./</span><span>$</span><span style="color:#bf616a;">i</span><span style="color:#a3be8c;">)</span><span>&quot;
</span></td></tr><tr><td>13</td><td><span>        </span><span style="color:#b48ead;">if </span><span style="color:#96b5b4;">[ </span><span>&quot;$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">owner</span><span style="color:#a3be8c;">}</span><span>&quot; = &quot;</span><span style="color:#a3be8c;">bandit23</span><span>&quot; </span><span style="color:#96b5b4;">]</span><span>; </span><span style="color:#b48ead;">then
</span></td></tr><tr><td>14</td><td><span>            </span><span style="color:#bf616a;">timeout -s</span><span> 9 60 ./$</span><span style="color:#bf616a;">i
</span></td></tr><tr><td>15</td><td><span>        </span><span style="color:#b48ead;">fi
</span></td></tr><tr><td>16</td><td><span>        </span><span style="color:#bf616a;">rm -f</span><span> ./$</span><span style="color:#bf616a;">i
</span></td></tr><tr><td>17</td><td><span>    </span><span style="color:#b48ead;">fi
</span></td></tr><tr><td>18</td><td><span style="color:#b48ead;">done
</span></td></tr></tbody></table></code></pre>
<p>According to the <code>echo</code> message, this script should be executing and deleting all the scripts in <code>/var/spool/bandit24/foo</code>.</p>
<p>So, presumably, if that <code>foo</code> directory is writable by <code>bandit23</code> then we could write a script. Copy it into that directory, and then simply wait for the cronjob to activate and run our script. Let's check.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ls -l /var/spool/bandit24/
</span><span>total 4
</span><span>drwxrwx-wx 62 root bandit24 4096 Jun 17 13:51 foo
</span></code></pre>
<p>Note the atypical <code>w</code> in the "other" portion of the directory permissions. That means we'll be able to copy in any scripts we'd like.</p>
<p>There are plenty of different ways you could solve this, but the simplest is to send the contents of the bandit24 password file to a new file which we can read. Here's an example solution.</p>
<pre data-linenos data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><table><tbody><tr><td>1</td><td><span style="color:#65737e;">#!/bin/sh
</span></td></tr><tr><td>2</td><td><span style="color:#bf616a;">mkdir -p</span><span> /tmp/cblanken_L24
</span></td></tr><tr><td>3</td><td><span style="color:#bf616a;">cat</span><span> /etc/bandit_pass/bandit24 &gt; /tmp/cblanken_L24/pass.txt
</span></td></tr></tbody></table></code></pre>
<p>Don't forget to swap in your own temporary directory name and make your script file executable with <code>chmod</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ chmod +x solve.sh
</span></code></pre>
<p>Then copy your script into <code>/var/spool/bandit24/foo</code> and wait for it to be executed.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cp solve.sh /var/spool/bandit24/foo/
</span></code></pre>
<p>The cronjob is triggered every minute, so you shouldn't have to wait long.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat /tmp/cblanken_L24/pass.txt
</span><span>[REDACTED LEVEL 24 PASSWSORD]
</span></code></pre>
<h3 id="level-24"><a class="zola-anchor" href="#level-24" aria-label="Anchor link for: level-24">Level 24</a></h3>
<blockquote>
<p>A daemon is listening on port 30002 and will give you the password for bandit25 if given the password for bandit24 and a secret numeric 4-digit pincode. There is no way to retrieve the pincode except by going through all of the 10000 combinations, called brute-forcing. You do not need to create new connections each time</p>
</blockquote>
<p>There are a lot of possible ways to solve this, but I recommend splitting it into two parts.</p>
<ol>
<li>First we need to generate these 4 digit PINs</li>
<li>Then we'll send them to port 30002.</li>
</ol>
<h4 id="generating-pins"><a class="zola-anchor" href="#generating-pins" aria-label="Anchor link for: generating-pins">Generating PINs</a></h4>
<p>One convenient way to do this is with the <a href="https://www.man7.org/linux/man-pages/man1/seq.1.html">seq</a> command which can generate sequences of numbers.</p>
<p>For example</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ seq 0 10
</span><span>0
</span><span>1
</span><span>2
</span><span>3
</span><span>4
</span><span>5
</span><span>6
</span><span>7
</span><span>8
</span><span>9
</span><span>10
</span></code></pre>
<p>You might notice though that all these single digits aren't exactly valid PINs. They should have leading zeroes up to 4 digits.</p>
<p>Fortunately, <code>seq</code> has a flag that will pad our numbers with leading zeroes just how we need using the <code>-w</code> flag. Here's an excerpt from the manual.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>-w, --equal-width
</span><span>   equalize width by padding with leading zeroes
</span></code></pre>
<p>Now we have our leading zeroes, and we just need to update the maximum argument from 10 to 9999 to get every possible 4-digit pin.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ seq -w 0 9999
</span><span>0000
</span><span>0001
</span><span>0002
</span><span>0003
</span><span>0004
</span><span>--- snip ---
</span><span>9995
</span><span>9996
</span><span>9997
</span><span>9998
</span><span>9999
</span></code></pre>
<p>Next let's see what we need to be sending to port 30002. If you start a connection to the port with netcat, the service will reply with a simple explanation.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ nc localhost 30002
</span><span>I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
</span></code></pre>
<p>It says here that the <code>bandit24</code> password and our PIN should be sent in a single line with a space separating the two. To write this all out, it would be a bit unwieldy to do it all directly from the shell, so let's write ourselves a Bash script.</p>
<p>We've already gone over some of the <a href="https://www.cblanken.dev/articles/overthewirebandit/#shell-scripting">basics</a>, but here we'll need to introduce some new syntax. The <code>for</code> loop.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;">#!/bin/bash
</span><span>
</span><span style="color:#65737e;"># Generate PINs
</span><span style="color:#b48ead;">for</span><span> i </span><span style="color:#b48ead;">in </span><span>$(</span><span style="color:#bf616a;">seq -w</span><span> 0 9999); </span><span style="color:#b48ead;">do
</span><span>   </span><span style="color:#96b5b4;">echo </span><span>&quot;</span><span style="color:#a3be8c;">[REDACTED LEVEL 24 PASSWORD] </span><span>$</span><span style="color:#bf616a;">i</span><span>&quot;
</span><span style="color:#b48ead;">done
</span></code></pre>
<p>Now, I want to return to something mentioned in the prompt. It reads.</p>
<blockquote>
<p>You do not need to create new connections each time.</p>
</blockquote>
<p>This is actually quite an important concept when writing scripts or doing any programming really. Understanding the requirements for the script you're writing and making it perform well without doing extra work or using resources that aren't strictly necessary. In this case the prompt has hinted to us that we really only need one connection to port 30002 to do all this work.</p>
<p>Now I want you to think about what this script will do with the addition of one line. Consider why this might be problematic.</p>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#b48ead;">for</span><span> i </span><span style="color:#b48ead;">in </span><span>$(</span><span style="color:#bf616a;">seq -w</span><span> 0 9999); </span><span style="color:#b48ead;">do
</span><span>   </span><span style="color:#96b5b4;">echo </span><span>&quot;</span><span style="color:#a3be8c;">[REDACTED LEVEL 24 PASSWORD] </span><span>$</span><span style="color:#bf616a;">i</span><span>&quot; | </span><span style="color:#bf616a;">nc</span><span> localhost 30002
</span><span style="color:#b48ead;">done
</span></code></pre>
<p>The problem here is that we've placed our call to <code>netcat</code> within our <code>for</code> loop. That means <code>netcat</code> will be creating and tearing down the connection to port 30002 for every iteration of this loop. If you try this script you'll also notice an even more glaring problem. The program actually hangs after sending only the first code. That's because netcat will await user input as long as the connection hasn't been closed and since the correct PIN wasn't sent, the service is still awaiting more input.</p>
<p>So we can already see this approach may cause some problems. Instead, let's generate all our numbers with our first script and then pass the output to netcat with a pipe. In this way, only one connection is required, and we can guarantee that all the PINs will be sent to the service on port 30002.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ./gen_pincodes.sh | nc localhost 30002
</span></code></pre>
<p>Running the script will yield the password once the correct PIN is reached.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>--- snip ---
</span><span>Wrong! Please enter the correct current password and pincode. Try again.
</span><span>Wrong! Please enter the correct current password and pincode. Try again.
</span><span>Wrong! Please enter the correct current password and pincode. Try again.
</span><span>Wrong! Please enter the correct current password and pincode. Try again.
</span><span>Correct!
</span><span>The password of user bandit25 is [REDACTED LEVEL 25 PASSWORD]
</span></code></pre>
<h3 id="level-25"><a class="zola-anchor" href="#level-25" aria-label="Anchor link for: level-25">Level 25</a></h3>
<blockquote>
<p>Logging in to bandit26 from bandit25 should be fairly easy… The shell for user bandit26 is not <code>/bin/bash</code>, but something else. Find out what it is, how it works and how to break out of it.</p>
<p>NOTE: if you’re a Windows user and typically use Powershell to ssh into bandit: Powershell is known to cause issues with the intended solution to this level. You should use command prompt instead.</p>
</blockquote>
<p>We're told bandit 26 runs some other shell than bash.</p>
<p>There are a couple ways to discover a user's default shell in Linux. One is the <code>/etc/passwd</code> file. It lists all the users of the system, whether they can login, and what default shell they have. We can cat <code>/etc/passwd</code> and search for bandit26 to discover its shell. Here's the relevant excerpt.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat /etc/passwd
</span><span>--- snip ---
</span><span>bandit24:x:11024:11024:bandit level 24:/home/bandit24:/bin/bash
</span><span>bandit25:x:11025:11025:bandit level 25:/home/bandit25:/bin/bash
</span><mark style="background-color:#65737e30;"><span>bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext
</span></mark><span>bandit27:x:11027:11027:bandit level 27:/home/bandit27:/bin/bash
</span><span>bandit28:x:11028:11028:bandit level 28:/home/bandit28:/bin/bash
</span><span>--- snip ---
</span></code></pre>
<p>To display this information in a more readable format, we can use the <a href="https://www.man7.org/linux/man-pages/man1/lslogins.1.html">lslogins</a> command as well.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ lslogins bandit26
</span><span>Username:                           bandit26
</span><span>UID:                                11026
</span><span>Gecos field:                        bandit level 26
</span><span>Home directory:                     /home/bandit26
</span><mark style="background-color:#65737e30;"><span>Shell:                              /usr/bin/showtext
</span></mark><span>No login:                           no
</span><span>Primary group:                      bandit26
</span><span>GID:                                11026
</span><span>Last login:                         14:03
</span><span>Last terminal:                      pts/171
</span><span>Last hostname:                      183.171.69.129
</span><span>Hushed:                             no
</span><span>Running processes:                  0
</span><span>
</span><span>Last logs:
</span></code></pre>
<p>Note how the Shell field for <code>bandit26</code> is <code>/usr/bin/showtext</code> as opposed to the other levels which use <code>/usr/bin/bash</code> as the default shell.</p>
<p>Running <code>file</code> on <code>/usr/bin/showtext</code> shows that it's a regular ASCII file.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ file /usr/bin/showtext
</span><span>/usr/bin/showtext: POSIX shell script, ASCII text executable
</span></code></pre>
<p>It's identified as a shell script, so let's read through it to see what it's doing.</p>
<pre data-linenos data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><table><tbody><tr><td>1</td><td><span style="color:#65737e;">#!/bin/sh
</span></td></tr><tr><td>2</td><td><span>
</span></td></tr><tr><td>3</td><td><span style="color:#b48ead;">export </span><span style="color:#bf616a;">TERM</span><span>=</span><span style="color:#a3be8c;">linux
</span></td></tr><tr><td>4</td><td><span>
</span></td></tr><tr><td>5</td><td><span style="color:#96b5b4;">exec</span><span> more </span><span style="color:#bf616a;">~</span><span>/text.txt
</span></td></tr><tr><td>6</td><td><span style="color:#96b5b4;">exit</span><span> 0
</span></td></tr></tbody></table></code></pre>
<p>Pretty short, it seems to be setting the <code>$TERM</code> shell variable to "linux" and then replaces the current shell with a <code>more</code> command with the file <code>/home/bandit26/text.txt</code> (remember the <code>~</code> will expand to the home directory of the user). We can't directly read the contents of the <code>text.txt</code> file from bandit25 but since the <code>more</code> pager is being used it should print the contents to the screen when we try to login as the bandit26 user.</p>
<h4 id="pagers"><a class="zola-anchor" href="#pagers" aria-label="Anchor link for: pagers">Pagers</a></h4>
<p>Before we continue though, we need to discuss a bit about pagers.</p>
<p>You might have already used one before, but this is our first look at a challenge that strictly requires the use of one. The pager used here is <a href="https://www.man7.org/linux/man-pages/man1/more.1.html"><code>more</code></a>, but it's more likely you'll have used <a href="https://www.man7.org/linux/man-pages/man1/less.1.html"><code>less</code></a> which is the default in many Linux distributions.</p>
<p>Essentially pagers allow us to view text in the terminal such that it's paginated. As opposed to printing an entire file with the <code>cat</code> command all in one shot. A pager like <code>more</code> will stop writing text once the screen is filled and then allow you to continue page by page until you've reached the end of the text. The <code>less</code> command has some more advanced text search features and allows moving forward <em>and backwards</em> through a file unlike <code>more</code>.</p>
<p>In any case, I'd recommend looking through the help menu of <code>less</code> (just press <code>h</code> after opening a file to see a summary of <code>less</code> commands).</p>
<pre data-linenos data-lang="txt" style="background-color:#2b303b;color:#c0c5ce;" class="language-txt "><code class="language-txt" data-lang="txt"><table><tbody><tr><td>1</td><td><span>                   SUMMARY OF LESS COMMANDS
</span></td></tr><tr><td>2</td><td><span>
</span></td></tr><tr><td>3</td><td><span>      Commands marked with * may be preceded by a number, N.
</span></td></tr><tr><td>4</td><td><span>      Notes in parentheses indicate the behavior if N is given.
</span></td></tr><tr><td>5</td><td><span>      A key preceded by a caret indicates the Ctrl key; thus ^K is ctrl-K.
</span></td></tr><tr><td>6</td><td><span>
</span></td></tr><tr><td>7</td><td><span>  h  H                 Display this help.
</span></td></tr><tr><td>8</td><td><span>  q  :q  Q  :Q  ZZ     Exit.
</span></td></tr><tr><td>9</td><td><span> ---------------------------------------------------------------------------
</span></td></tr><tr><td>10</td><td><span>
</span></td></tr><tr><td>11</td><td><span>                           MOVING
</span></td></tr><tr><td>12</td><td><span>
</span></td></tr><tr><td>13</td><td><span>  e  ^E  j  ^N  CR  *  Forward  one line   (or N lines).
</span></td></tr><tr><td>14</td><td><span>  y  ^Y  k  ^K  ^P  *  Backward one line   (or N lines).
</span></td></tr><tr><td>15</td><td><span>  f  ^F  ^V  SPACE  *  Forward  one window (or N lines).
</span></td></tr><tr><td>16</td><td><span>  b  ^B  ESC-v      *  Backward one window (or N lines).
</span></td></tr><tr><td>17</td><td><span>  z                 *  Forward  one window (and set window to N).
</span></td></tr><tr><td>18</td><td><span>  w                 *  Backward one window (and set window to N).
</span></td></tr><tr><td>19</td><td><span>  ESC-SPACE         *  Forward  one window, but don&#39;t stop at end-of-file.
</span></td></tr><tr><td>20</td><td><span>  d  ^D             *  Forward  one half-window (and set half-window to N).
</span></td></tr><tr><td>21</td><td><span>  u  ^U             *  Backward one half-window (and set half-window to N).
</span></td></tr><tr><td>22</td><td><span>  ESC-)  RightArrow *  Right one half screen width (or N positions).
</span></td></tr><tr><td>23</td><td><span>  ESC-(  LeftArrow  *  Left  one half screen width (or N positions).
</span></td></tr><tr><td>24</td><td><span>  ESC-}  ^RightArrow   Right to last column displayed.
</span></td></tr><tr><td>25</td><td><span>  ESC-{  ^LeftArrow    Left  to first column.
</span></td></tr><tr><td>26</td><td><span>  F                    Forward forever; like &quot;tail -f&quot;.
</span></td></tr><tr><td>27</td><td><span>HELP -- Press RETURN for more, or q when done
</span></td></tr></tbody></table></code></pre>
<p>Now back to the challenge at hand.</p>
<h4 id="solution-3"><a class="zola-anchor" href="#solution-3" aria-label="Anchor link for: solution-3">Solution</a></h4>
<p>Bandit 25 has an ssh key for bandit 26 in the home directory. We'll retrieve that first so we can ssh directly into bandit 26. But, if you try to login with this key we're greeted with the usual message followed by a closed connection.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ssh bandit26@bandit.labs.overthewire.org -i bandit26.key
</span><span>--- snip ---
</span><span>--[ More information ]--
</span><span>
</span><span>  For more information regarding individual wargames, visit
</span><span>  http://www.overthewire.org/wargames/
</span><span>
</span><span>  For support, questions or comments, contact us on discord or IRC.
</span><span>
</span><span>  Enjoy your stay!
</span><span>
</span><span>  _                     _ _ _   ___   __
</span><span> | |                   | (_) | |__ \ / /
</span><span> | |__   __ _ _ __   __| |_| |_   ) / /_
</span><span> | &#39;_ \ / _` | &#39;_ \ / _` | | __| / / &#39;_ \
</span><span> | |_) | (_| | | | | (_| | | |_ / /| (_) |
</span><span> |_.__/ \__,_|_| |_|\__,_|_|\__|____\___/
</span><mark style="background-color:#65737e30;"><span>Connection to bandit.labs.overthewire.org closed.
</span></mark></code></pre>
<p>The crux of this challenge relies on that fact that the paging of <code>more</code> is dependent upon the size of the text input. If the number of lines of text exceed the available lines on-screen then <code>more</code> will paginate the output, otherwise it behaves like the <code>cat</code> command. So, in the case above, my terminal was able to print the entire <code>text.txt</code> file which we can probably assume contains the ASCII art of bandit26 since that's the last thing we see and the only thing that deviates from the normal welcome message from previous levels.</p>
<p>So, that means it should be possible to trigger the pager by shrinking the height of our terminal to less than 6 lines high.</p>
<p><img src="/images/otw-bandit/level_26_more_1.png" alt="level 26 more truncation" /></p>
<p>Since the output is paginated, the connection doesn't immediately end because the <code>more</code> program is waiting for us to page through the remaining content. However, <code>more</code> has some other features that can help us escape this prompt. If you press either the <code>h</code> or <code>?</code> key while on this prompt, <code>more</code> will list out a summary of commands. One of which includes the option to execute commands in a subshell. <img src="/images/otw-bandit/level_26_more_help.png" alt="level 26 more help" /></p>
<p>This is promising and there may be a way to execute commands directly via <code>more</code> to retrieve the bandit26 password and to solve for the next one. However, it's quite laborious since <code>more</code> won't yield any output for any commands we run, so we would have to write to various temporary files to manage it.</p>
<p>Instead, I'm going to show you a neat trick with Vi. If you look carefully there's an option just below the <code>!&lt;cmd&gt;</code> option. The <code>v</code> command which will open <code>vi</code>.</p>
<h4 id="vi-and-vim"><a class="zola-anchor" href="#vi-and-vim" aria-label="Anchor link for: vi-and-vim">Vi and Vim</a></h4>
<p>Vi is a powerful text editor that is a common default on Linux systems. You may have also heard of its descendant Vim which has even more capabilities.</p>
<p>I won't be going into much detail on the features of Vim here. Just enough to demonstrate the solution, but I highly recommend working through the beginner section of the <a href="https://thevaluable.dev/vim-commands-beginner/">Vim Guide</a> by <a href="https://thevaluable.dev">The Valuable Dev</a> if you're interested in discovering its power.</p>
<p>From here on out I'll refer to Vi and Vim collectively as Vim for simplicity. Just be aware they are in fact distinct. Even if we don't run into any distinguishing features in this walkthrough.</p>
<p>Firstly, Vim is not a typical text editor like most folks are familiar with like Windows' Notepad and Apple's TextEdit. Vim exists entirely in the terminal and was designed to function entirely without a pointing device like a mouse. Vim is what's known as a modal editor. Instead of always interpreting input from the keyboard as text to be written, Vim has several different modes:</p>
<ul>
<li>normal mode (this is the default mode usually used for navigating your files)</li>
<li>insert mode (this is like your typical text editors)</li>
<li>visual mode (kind of like when you select text with your mouse in other editors)</li>
<li>command mode</li>
</ul>
<p>The main thing you need to know for this challenge is that the colon <code>:</code> is used to enter command mode.</p>
<p>The first command we'll use is <code>:edit</code>. This command will open a file so let's use it to grab the bandit26 password.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>:edit /etc/bandit_pass/bandit26
</span></code></pre>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>[REDACTED BANDIT 26 PASSWORD]
</span><span>~
</span><span>~
</span><span>~
</span><span>~
</span><span>~
</span><span>&quot;/etc/bandit_pass/bandit26&quot; [readonly] 1L, 33B           1,1           All
</span></code></pre>
<p>While this is a good first step, we still need some way access a shell to complete the next level.</p>
<p>Fortunately Vim can also open a shell with the <code>:shell</code> command. You can read more about it with the <code>:help</code> command. The full command is <code>:help :shell</code>.</p>
<p><img src="/images/otw-bandit/level_25_vim_shell_help.png" alt="Vim :shell help" /></p>
<p>Unfortunately, by default, it uses the same shell that spawned the process. Use the set command to change the mentioned <code>shell</code> variable like so.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>:set shell=/bin/bash
</span></code></pre>
<p>At last, we can open a bash shell with the <code>:shell</code> command.</p>
<p><img src="/images/otw-bandit/level_25_vim_shell.png" alt="Vim shell" /></p>
<h3 id="level-26"><a class="zola-anchor" href="#level-26" aria-label="Anchor link for: level-26">Level 26</a></h3>
<blockquote>
<p>Good job getting a shell! Now hurry and grab the password for bandit27!</p>
</blockquote>
<ul>
<li>If we look in the home directory of bandit27 we'll find a setuid script called <code>bandit27-do</code>. When we run it we get the following output.</li>
</ul>
<p>This level is essentially a duplicate of <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-19">Level 19</a> since the real difficulty is in gaining a shell via <code>more</code> as shown in <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-25">Level 25</a>.</p>
<p>The suid binary <code>bandit27-do</code> is available in the home directory.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ./bandit27-do
</span><span>Run a command as another user.
</span><span>  Example: ./bandit27-do id
</span></code></pre>
<p>Print the bandit27 password like so.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ ./bandit27-do cat /etc/bandit_pass/bandit27
</span><span>[REDACTED BANDIT 27 PASSWORD]
</span></code></pre>
<h3 id="level-27"><a class="zola-anchor" href="#level-27" aria-label="Anchor link for: level-27">Level 27</a></h3>
<blockquote>
<p>There is a git repository at <code>ssh://bandit27-git@localhost/home/bandit27-git/</code> repo via the port 2220. The password for the user bandit27-git is the same as for the user <code>bandit27</code>.</p>
<p>Clone the repository and find the password for the next level.</p>
</blockquote>
<h4 id="git"><a class="zola-anchor" href="#git" aria-label="Anchor link for: git">Git</a></h4>
<p>Git is a software version control system. As of this writing Git is probably the most popular version control system for software and has been for a while. At any rate, you'll likely come across it while doing any kind of IT administration or security work.</p>
<p>The best resource to learn about Git is probably the <a href="https://git-scm.com/docs">reference documentation</a> and the <a href="https://git-scm.com/book/en/v2">Pro Git book</a> which is freely available online, but it isn't necessary to know a lot of details for these challenges.</p>
<p>To start you really only need to know a few commands.</p>
<table><thead><tr><th>Git Command</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://git-scm.com/docs/git-clone"><kbd>git-clone(1)</kbd></a></td><td>download a repository from a remote system</td></tr>
<tr><td><a href="https://git-scm.com/docs/git-checkout"><kbd>git-checkout(1)</kbd></a></td><td>interact with the repository at a certain commit</td></tr>
<tr><td><a href="https://git-scm.com/docs/git-log"><kbd>git-log(1)</kbd></a></td><td>list commits</td></tr>
<tr><td><a href="https://git-scm.com/docs/git-branch"><kbd>git-branch(1)</kbd></a></td><td>list branches</td></tr>
</tbody></table>
<p>The repository mentioned in the prompt can be cloned with the following command.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git clone ssh://bandit27-git@localhost:2220/home/bandit27-git/repo
</span></code></pre>
<p>After entering the level password, the git clone should complete with some progress indicators.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>remote: Enumerating objects: 3, done.
</span><span>remote: Counting objects: 100% (3/3), done.
</span><span>remote: Compressing objects: 100% (2/2), done.
</span><span>Receiving objects: 100% (3/3), done.
</span><span>remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
</span></code></pre>
<p>And, there should now be a directory named <code>repo</code> in the current directory.</p>
<p>The repository contains a single README file which contains the password.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat README
</span><span>The password to the next level is: [REDACTED LEVEL 28 PASSWORD]
</span></code></pre>
<h3 id="level-28"><a class="zola-anchor" href="#level-28" aria-label="Anchor link for: level-28">Level 28</a></h3>
<blockquote>
<p>There is a git repository at <code>ssh://bandit28-git@localhost/home/bandit28-git/</code> repo via the port 2220. The password for the user bandit28-git is the same as for the user <code>bandit28</code>.</p>
<p>Clone the repository and find the password for the next level.</p>
</blockquote>
<p>Just as before, clone the repository.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git clone ssh://bandit28-git@localhost:2220/home/bandit28-git/repo
</span></code></pre>
<p>This time, the <code>README</code> file contains a password that has been redacted.</p>
<pre data-lang="md" style="background-color:#2b303b;color:#c0c5ce;" class="language-md "><code class="language-md" data-lang="md"><span style="color:#8fa1b3;"># Bandit Notes
</span><span>
</span><span>Some notes for level29 of bandit.
</span><span>
</span><span style="color:#8fa1b3;">## credentials
</span><span>
</span><span style="color:#bf616a;">- username: bandit29
</span><span style="color:#bf616a;">- password: xxxxxxxxxx
</span></code></pre>
<p>Examine the change history with the <code>git log</code> command.</p>
<pre data-lang="gitlog" style="background-color:#2b303b;color:#c0c5ce;" class="language-gitlog "><code class="language-gitlog" data-lang="gitlog"><span>commit 674690a00a0056ab96048f7317b9ec20c057c06b (HEAD -&gt; master, origin/master, origin/HEAD)
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Morla Porla &lt;morla@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:19 2025 +0000
</span><span>
</span><mark style="background-color:#65737e30;"><span>    fix info leak
</span></mark><span>
</span><span style="color:#b48ead;">commit </span><span style="color:#d08770;">fb0df1358b1ff146f581651a84bae622353a71c0
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Morla Porla &lt;morla@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:19 2025 +0000
</span><span>
</span><span>    add missing data
</span><span>
</span><span style="color:#b48ead;">commit </span><span style="color:#d08770;">a5fdc97aae2c6f0e6c1e722877a100f24bcaaa46
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Ben Dover &lt;noone@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:19 2025 +0000
</span><span>
</span><span>    initial commit of README.md
</span></code></pre>
<p>There's a reference to an "info leak" from the previous commit. Check out the previous commit with the <code>git checkout</code> command.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git checkout fb0df1358b1ff146f581651a84bae622353a71c0
</span></code></pre>
<p>This will change the repository to its original state at the specified commit hash.</p>
<p>At this point in the repositories history, the bnadit29 password had not yet been redacted in the <code>README</code> file.</p>
<pre data-lang="md" style="background-color:#2b303b;color:#c0c5ce;" class="language-md "><code class="language-md" data-lang="md"><span style="color:#8fa1b3;"># Bandit Notes
</span><span>
</span><span>Some notes for level29 of bandit.
</span><span>
</span><span style="color:#8fa1b3;">## credentials
</span><span>
</span><span style="color:#bf616a;">- username: bandit29
</span><span style="color:#bf616a;">- password: [REDACTED LEVEL 29 PASSWORD]
</span></code></pre>
<h3 id="level-29"><a class="zola-anchor" href="#level-29" aria-label="Anchor link for: level-29">Level 29</a></h3>
<blockquote>
<p>There is a git repository at <code>ssh://bandit29-git@localhost/home/bandit29-git/</code> repo via the port 2220. The password for the user bandit29-git is the same as for the user <code>bandit29</code>.</p>
<p>Clone the repository and find the password for the next level.</p>
</blockquote>
<p>Clone the repository.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git clone ssh://bandit29-git@localhost:2220/home/bandit29-git/repo
</span></code></pre>
<p>Similar to <a href="https://www.cblanken.dev/articles/overthewirebandit/#level-28">Level 28</a> there is a <code>README</code> file.</p>
<pre data-lang="md" style="background-color:#2b303b;color:#c0c5ce;" class="language-md "><code class="language-md" data-lang="md"><span style="color:#8fa1b3;"># Bandit Notes
</span><span>
</span><span>Some notes for bandit30 of bandit.
</span><span>
</span><span style="color:#8fa1b3;">## credentials
</span><span>
</span><span style="color:#bf616a;">- username: bandit30
</span><span style="color:#bf616a;">- password: &lt;no </span><span style="color:#d08770;">passwords in production!</span><span style="color:#bf616a;">&gt;
</span></code></pre>
<p>Looking at the log again doesn't turn up anything interesting.</p>
<pre data-lang="gitlog" style="background-color:#2b303b;color:#c0c5ce;" class="language-gitlog "><code class="language-gitlog" data-lang="gitlog"><span>commit 3910630172946c9ffb75842922e394b772c672bd (HEAD)
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Ben Dover &lt;noone@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:21 2025 +0000
</span><span>
</span><span>    add gif2ascii
</span><span>
</span><span>commit 3b8b91fc3c48f1a19d05670fd45d3e3f2621fcfa (origin/master, origin/HEAD, master)
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Ben Dover &lt;noone@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:21 2025 +0000
</span><span>
</span><span>    fix username
</span><span>
</span><span style="color:#b48ead;">commit </span><span style="color:#d08770;">8d2ffeb5e45f87d0abb028aa796e3ebb63c5579c
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Ben Dover &lt;noone@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:21 2025 +0000
</span><span>
</span><span>    initial commit of README.md
</span></code></pre>
<p>This is where some knowledge of Git's branching is useful. By default, the <code>git log</code> command will only display commits from current branch. In this case the <code>master</code> branch.</p>
<p>Use the <code>git branch</code> command to show the active branch.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git branch
</span><span>* master
</span></code></pre>
<p>Additionally using the <code>--all</code> flag will list all the local and <em>remote</em> branches.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git branch --all
</span><span>* master
</span><span>  remotes/origin/HEAD -&gt; origin/master
</span><span>  remotes/origin/dev
</span><span>  remotes/origin/master
</span><span>  remotes/origin/sploits-dev
</span></code></pre>
<p>You can see here that there are two additional branches mentioned. The <code>dev</code> and <code>sploits-dev</code> branches. Let's check them out.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git checkout dev
</span><span>Switched to branch &#39;dev&#39;
</span><span>Your branch is up to date with &#39;origin/dev&#39;.
</span></code></pre>
<pre data-lang="gitlog" style="background-color:#2b303b;color:#c0c5ce;" class="language-gitlog "><code class="language-gitlog" data-lang="gitlog"><span>commit a97d0dbf8fd910ead6fcf648829ff55c1a629c8e (HEAD -&gt; dev, origin/dev)
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Morla Porla &lt;morla@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:21 2025 +0000
</span><span>
</span><span>    add data needed for development
</span><span>
</span><span style="color:#b48ead;">commit </span><span style="color:#d08770;">3910630172946c9ffb75842922e394b772c672bd
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Ben Dover &lt;noone@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:21 2025 +0000
</span><span>
</span><span>    add gif2ascii
</span><span>
</span><span>commit 3b8b91fc3c48f1a19d05670fd45d3e3f2621fcfa (origin/master, origin/HEAD, master)
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Ben Dover &lt;noone@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:21 2025 +0000
</span><span>
</span><span>    fix username
</span><span>
</span><span style="color:#b48ead;">commit </span><span style="color:#d08770;">8d2ffeb5e45f87d0abb028aa796e3ebb63c5579c
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Ben Dover &lt;noone@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:21 2025 +0000
</span><span>
</span><span>    initial commit of README.md
</span></code></pre>
<p>The <code>git show</code> command will print the changes made by the last commit, but you can alternatively, just read the <code>README</code> file while on the <code>dev</code> branch since the last commit contains the password.</p>
<pre data-lang="gitlog" style="background-color:#2b303b;color:#c0c5ce;" class="language-gitlog "><code class="language-gitlog" data-lang="gitlog"><span>commit a97d0dbf8fd910ead6fcf648829ff55c1a629c8e (HEAD -&gt; dev, origin/dev)
</span><span style="color:#b48ead;">Author</span><span>: </span><span style="color:#a3be8c;">Morla Porla &lt;morla@overthewire.org&gt;
</span><span style="color:#b48ead;">Date</span><span>:   </span><span style="color:#a3be8c;">Thu Apr 10 14:23:21 2025 +0000
</span><span>
</span><span>    add data needed for development
</span><span>
</span><span>diff --git a/README.md b/README.md
</span><span>index </span><span style="color:#d08770;">1af21d3</span><span>..</span><span style="color:#d08770;">bc6ad3d</span><span> 100644
</span><span>--- a/README.md
</span><span>+++ b/README.md
</span><span>@@ -4,5 +4,5 @@ Some notes for bandit30 of bandit.
</span><span> ## credentials
</span><span>
</span><span> - username: bandit30
</span><span>-- password: &lt;no passwords in production!&gt;
</span><span>+- password: [REDACTED BANDIT 30 PASSWORD]
</span></code></pre>
<p>The password only appears in the <code>dev</code> branch because it was only added in the <code>dev</code> branch, but never actually merged into <code>master</code>.</p>
<h3 id="level-30"><a class="zola-anchor" href="#level-30" aria-label="Anchor link for: level-30">Level 30</a></h3>
<blockquote>
<p>There is a git repository at <code>ssh://bandit30-git@localhost/home/bandit30-git/</code> repo via the port 2220. The password for the user bandit30-git is the same as for the user <code>bandit30</code>.</p>
<p>Clone the repository and find the password for the next level.</p>
</blockquote>
<p>Clone the repository.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git clone ssh://bandit30-git@localhost:2220/home/bandit30-git/repo
</span></code></pre>
<p>If we run <code>git log --all</code> there doesn't appear to be anything unusual.</p>
<p>This time we'll need to look at something called <a href="https://git-scm.com/book/en/v2/Git-Basics-Tagging">Tags</a> and a couple new commands.</p>
<table><thead><tr><th>Git Command</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://git-scm.com/docs/git-clone"><kbd>git-tag(1)</kbd></a></td><td>create, list, delete or verify tags</td></tr>
<tr><td><a href="https://git-scm.com/docs/git-checkout"><kbd>git-show(1)</kbd></a></td><td>show various git object i.e. blobs, commits, tags, and trees</td></tr>
</tbody></table>
<p>Here we'll list the existing tags for the repo.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git tag
</span><span>secret
</span></code></pre>
<p>Usually tags are used to mark specific commits, but if you try to <code>git checkout</code> this <code>secret</code> tag you'll get an error saying the reference is not a tree. This means the tag is just a BLOB (Binary Large OBject). You can read more about trees and blobs <a href="https://git-scm.com/book/en/v2/Git-Internals-Git-Objects">here</a>.</p>
<p>To show the contents of a blob we can use the <code>git show</code> command which reveals the next password.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git show secret
</span><span>[REDACTED LEVEL 31 PASSWORD]
</span></code></pre>
<h3 id="level-31"><a class="zola-anchor" href="#level-31" aria-label="Anchor link for: level-31">Level 31</a></h3>
<blockquote>
<p>There is a git repository at ssh://bandit31-git@localhost/home/bandit31-git/repo via the port 2220. The password for the user bandit31-git is the same as for the user bandit31.</p>
<p>Clone the repository and find the password for the next level.</p>
</blockquote>
<p>Clone the repo.</p>
<p>The <code>README.md</code> tells us to push a file to the remote with some file details.</p>
<!-- prettier-ignore-start -->
<pre data-lang="md" style="background-color:#2b303b;color:#c0c5ce;" class="language-md "><code class="language-md" data-lang="md"><span>This time your task is to push a file to the remote repository.
</span><span>
</span><span>Details:
</span><span>   File name: key.txt
</span><span>   Content: &#39;May I come in?&#39;
</span><span>   Branch: master
</span></code></pre>
<!-- prettier-ignore-end -->
<p>We'll need a couple new commands to do that.</p>
<table><thead><tr><th>Git Command</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://git-scm.com/docs/git-status"><kbd>git-status(1)</kbd></a></td><td>display the status of the working tree</td></tr>
<tr><td><a href="https://git-scm.com/docs/git-add"><kbd>git-add(1)</kbd></a></td><td>add files to the staging area</td></tr>
<tr><td><a href="https://git-scm.com/docs/git-push"><kbd>git-push(1)</kbd></a></td><td>create a new commit based on the current changes and add a commit message</td></tr>
</tbody></table>
<p>Next we need to create the <code>key.txt</code> file.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ echo &quot;May I come in?&quot; &gt; key.txt
</span></code></pre>
<p>Then add the <code>key.txt</code> to our index.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git add key.txt
</span><span>The following paths are ignored by one of your .gitignore files:
</span><span>key.txt
</span><span>hint: Use -f if you really want to add them.
</span><span>hint: Turn this message off by running
</span><span>hint: &quot;git config advice.addIgnoredFile false&quot;
</span></code></pre>
<p>You can read more about the mentioned <code>.gitignore</code> files <a href="https://git-scm.com/docs/gitignore">here</a>, but in this case we can just use the recommended <code>-f</code> flag to add the file and try again.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git add -f key.txt
</span></code></pre>
<p>We can verify that the <code>key.txt</code> file has been added to the index with <code>git status</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git status
</span><span>On branch master
</span><span>Your branch is up to date with &#39;origin/master&#39;.
</span><span>
</span><span>Changes to be committed:
</span><span>  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)
</span><mark style="background-color:#65737e30;"><span>        new file:   key.txt
</span></mark></code></pre>
<p>Now we need to commit this change with the <code>git commit</code> command. This applies our changes to the <code>master</code> branch.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git commit -m &quot;Add key.txt&quot;
</span><span>[master a1f8c06] Add key.txt
</span><span> 1 file changed, 1 insertion(+)
</span><span> create mode 100644 key.txt
</span></code></pre>
<p>And finally, we can use the <code>git push</code> command to push our new commit to the remote repository.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ git push origin master
</span></code></pre>
<svg 
  version="1.1" 
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  style="display: none;">
    <style>
        .info-text {
            font-size: 60px;
            font-weight: 600;
            font-family: 'Atkinson Hyperlegible', 'Tahoma', 'Arial';
        }
    </style>
    <symbol id="info" viewBox="0 0 100 100">
        <circle
           id="info-circle"
           stroke="currentColor"
           stroke-width="10"
           cx="50"
           cy="50"
           r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">i</text>
    </symbol>
    <symbol id="warn" viewBox="0 0 100 100">
        <circle
          id="warning-circle"
          stroke="currentColor"
          stroke-width="10"
          cx="50"
          cy="50"
          r="45" />
        <text class="info-text" x="50" y="50" dy=".26rem" text-anchor="middle" dominant-baseline="middle" fill="currentColor">!</text>
    </symbol>
    <symbol id="tip" viewBox="0 0 285 285">
        <polygon
          id="tip-star"
          stroke="#efefef"
          stroke-width="20"
          points="150,15 258,77 258,202 150,265 42,202 42,77"
          fill="currentColor"
        />
    </symbol>
</svg>


<div class="callout warning">
  <div class="callout-head">
    <svg class="icon"><use xlink:href="#warn"></use></svg>
    <div>Warning</div>
  </div>
  <div class="callout-text">
    <p>Watch out! If the content of <code>key.txt</code> does not match the prescribed text <em>exactly</em> you may receive an error like this.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Enumerating objects: 4, done.
</span><span>Counting objects: 100% (4/4), done.
</span><span>Delta compression using up to 2 threads
</span><span>Compressing objects: 100% (2/2), done.
</span><span>Writing objects: 100% (3/3), 323 bytes | 323.00 KiB/s, done.
</span><span>Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
</span><mark style="background-color:#65737e30;"><span>remote: ### Attempting to validate files... ####
</span></mark><mark style="background-color:#65737e30;"><span>remote:
</span></mark><mark style="background-color:#65737e30;"><span>remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
</span></mark><mark style="background-color:#65737e30;"><span>remote:
</span></mark><mark style="background-color:#65737e30;"><span>remote: Wrong!
</span></mark><mark style="background-color:#65737e30;"><span>remote:
</span></mark><mark style="background-color:#65737e30;"><span>remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
</span></mark><span>remote:
</span><span>To ssh://localhost:2220/home/bandit31-git/repo
</span><span> ! [remote rejected] master -&gt; master (pre-receive hook declined)
</span><span>error: failed to push some refs to &#39;ssh://localhost:2220/home/bandit31-git/repo&#39;
</span></code></pre>

  </div>
</div>


<style>
</style>
<p>If everything is in order, you'll get some feedback from the git server which will include the next password.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>remote: ### Attempting to validate files... ####
</span><span>remote:
</span><span>remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
</span><span>remote:
</span><mark style="background-color:#65737e30;"><span>remote: Well done! Here is the password for the next level:
</span></mark><mark style="background-color:#65737e30;"><span>remote: [REDACTED LEVEL32 PASSWORD]
</span></mark><span>remote:
</span><span>remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
</span><span>remote:
</span><span>To ssh://localhost:2220/home/bandit31-git/repo
</span><span> ! [remote rejected] master -&gt; master (pre-receive hook declined)
</span><span>error: failed to push some refs to &#39;ssh://localhost:2220/home/bandit31-git/repo&#39;
</span></code></pre>
<h3 id="level-32"><a class="zola-anchor" href="#level-32" aria-label="Anchor link for: level-32">Level 32</a></h3>
<blockquote>
<p>After all this git stuff, it’s time for another escape. Good luck!</p>
</blockquote>
<p>After logging in to bandit32 you'll find yourself in an "UPPERCASE" shell, all entered text appears to be converted to uppercase.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>WELCOME TO THE UPPERCASE SHELL
</span><span>&gt;&gt; cat /etc/passwd
</span><span>sh: 1: CAT: Permission denied
</span><span>&gt;&gt;
</span></code></pre>
<p>It's possible to reference some environment variables such as <code>$PATH</code>, <code>$PWD</code>, <code>$SHELL</code>, and <code>$USER</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>&gt;&gt; $PATH
</span><span>sh: 1: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin: not found
</span><span>&gt;&gt; $PWD
</span><span>sh: 1: /home/bandit32: Permission denied
</span><span>&gt;&gt; $USER
</span><span>sh: 1: bandit32: Permission denied
</span></code></pre>
<p>You see, just accessing the variable, the Uppercase Shell tries to execute the contents seemingly with the <code>sh</code> shell. This is great, but not enough.</p>
<p>You have to know about a special shell variable, <code>$0</code>. The <code>$0</code> shell variable expands to the name of the shell or shell script being executed which in this case is <code>sh</code>.</p>
<p>Therefore, providing the <code>$0</code> variable will execute the <code>sh</code> command dropping us into a normal shell.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>&gt;&gt; $0
</span><span>$
</span></code></pre>
<p>From here's it's just a matter of printing the next password from the file as we've done many times before.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ cat /etc/bandit_pass/bandit33
</span><span>[REDACTED LEVEL33 PASSWORD]
</span></code></pre>
<h2 id="the-end"><a class="zola-anchor" href="#the-end" aria-label="Anchor link for: the-end">The End</a></h2>
<p>Congratulations! You made it! I hope you had fun working through all these challenges. There were a couple tricky ones that I didn't get them all myself on the first time around.</p>
<p>If this wargame has piqued your interest I've also written a couple other walkthroughs.</p>
<ul>
<li><a href="https://www.cblanken.dev/articles/overthewirenatas/">OverTheWire Natas</a></li>
<li><a href="https://www.cblanken.dev/articles/overthewireleviathan/">OverTheWire Leviathan</a></li>
</ul>
<p>If the OverTheWire wargames aren't quite your cup of tea though, then I highly recommend the <a href="https://picoctf.org">picoCTF</a> platform run by Carnegie Mellon University. They host an annual CTF event, but challenges from previous years are all available to practice. The picoCTF challenges cover a wide range of topics and levels of difficulty so that anyone can find something interesting.</p>
<p>Finally, a big thanks to the folks at <a href="https://overthewire.org/">OverTheWire</a> for maintaining the infrastructure for the OverTheWire wargames. They're such a great resource for folks first dipping their toes into cybersecurity and CTFs.</p>
<p>Happy hacking!</p>
<footer class="footnotes">
<ol class="footnotes-list">
<li id="fn-1">
<p>Just like almost every cryptographic system, it's possible for SSH to be used incorrectly, thus <a href="https://sandflysecurity.com/blog/ssh-key-compromise-risks-and-countermeasures/">compromising it's security</a>. <a href="#fr-1-1">↩</a></p>
</li>
<li id="fn-2">
<p>SSL and TLS both commonly refer to <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer Security</a> which is a protocol designed for secure communications over computer networks. SSL (Secure Sockets Layer) is a legacy term referring to the precursor to TLS, but the terms are often used interchangeably. However, modern applications should not be communicating via SSL since its final version (SSL 3.0) was deprecated in 2015. <a href="#fr-2-1">↩</a></p>
</li>
<li id="fn-3">
<p>Ports 1-1024 are privileged ports and can't be used without root permissions. That's because commonly known services are hosted on these ports and should ideally only be accessible by a system administrator. Anything from 1025 to 65535 should be fine though. If by chance you receive an error message of <code>nc: Address already in use</code>, then try another. <a href="#fr-3-1">↩</a></p>
</li>
<li id="fn-4">
<p>Some programs, in particular archiving and compression utilities like <code>tar</code>, <code>gzip</code>, and <code>bzip2</code> will refuse to operate on files without an appropriate file extension, but most programs will instead read the first few bytes of a file to determine it's type. Commonly known as <a href="https://en.wikipedia.org/wiki/List_of_file_signatures">magic numbers</a> <a href="#fr-4-1">↩</a></p>
</li>
</ol>
</footer>
</div>  
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Read more</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    <span class="button previous">
      <span class="button__icon">«&nbsp;</span>
      <a href="https://www.cblanken.dev/articles/janken/">
        <span class="button__text">HTB Apocalypse 2023 - Janken</span>
      </a>
    </span>
     
    <span class="button next">
      <a href="https://www.cblanken.dev/articles/overthewireleviathan/">
        <span class="button__text">OverTheWire - Leviathan</span>
      </a>
      <span class="button__icon">&nbsp;»</span>
    </span>
    </div>
</div>

</div>


    
    <footer class="footer">
        <div class="footer__inner">
                <div class="copyright">
                        <div>© 
    2025
 Cameron Blankenbuehler</div>
                    <div class="copyright-theme">
                        <div>Theme: <a href="https://github.com/cblanken/zola-theme-terminimal/">Terminimal</a></div>
                    </div>
                </div>
            </div>
    </footer>
    

</div>
</body>

</html>
